<!DOCTYPE HTML>

<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <title>ARITS Document Repository</title>
    <link th:rel="stylesheet" th:href="@{assets/jquery-treetable/jquery.treetable.css}"/>
    <link th:rel="stylesheet" th:href="@{assets/jquery-treetable/jquery.treetable.theme.default.css}"/>
    <link th:rel="stylesheet" th:href="@{webjars/bootstrap/4.0.0-2/css/bootstrap.min.css} "/>
    <!--  <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap_light.min.css" media="screen" />-->
    <script src="../assets/js/jquery-3.3.1.slim.min.js"></script>
    <!--    <script src="../assets/js/bootstrap.min.js"></script>-->
    <!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="../assets/css/all.css">
    <link rel="stylesheet" href="../assets/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/dms_custom.css">

</head>

<body id="bodyId" style="font-size: 12px; line-height: 1; height: 93%;">

<div th:if="${session.userDetails == null}">
    <script type="text/javascript">
        window.location.href = "/login";
    </script>
</div>



<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark static-top">
    <div class="navbar-inner">

        <a class="navbar-brand mx-auto" href="/" style="position: relative; left: 40px">
            <!-- code to align the element in vertically center <a class="navbar-brand mx-auto" href="/" style="position: relative; left: 40px"> -->
            <img src="assets/arits logo bw2.png">&nbsp;&nbsp;ARITS</a>
        <span th:if="${session.userDetails != null}"
              style="font-size: 1rem; color: #fff; position: absolute; right: 100px" class="navbar-brand mx-auto">
				<!-- <span id="DocRepo" onclick="listDocuments();"> Documents Repo </span>| -->
            <!-- <span id="UserRepo" onclick="listUsers();"> User Repo </span>  -->
				&nbsp;&nbsp;
				&nbsp;<span th:text="${session.userDetails.userName}"/>
            <!-- (<span th:text="${session.userDetails.userGroup}" />) -->
				&nbsp;&nbsp; 
				<span th:if="${session.userDetails.userGroup == 'ADMIN'}">
				<a href=#><img src="assets/product-documents-25.png" alt="Documents" title="Documents"
                               onclick="listDocuments();"></a>
				&nbsp;&nbsp;
                    <!--				<a href=#><img src="assets/admin-settings-male-25.png" alt="User Settings" title="User Settings"-->
                    <!--                               onclick="listUsers();"></a>-->
				&nbsp;

                <a href=#><img src="assets/usergroup.png" alt="User Groups" title="User Groups"
                               onclick="listUserGroups();"></a>
				&nbsp;&nbsp;
				 <a href=#><img src="assets/usergroup.png" alt="User Groups" title="User Groups"
                               onclick="listLog();"></a>
				&nbsp;&nbsp;</span>
            <!-- <spanonclick="logout()">Logout -->
				<a href=#><img src="assets/logout-20.png" alt="Logout" title="Logout" onclick="logout();"></a>
				</span>&nbsp;
        </span>

        <button class="navbar-toggler" type="button" data-toggle="collapse"
                data-target="#navbarResponsive" aria-controls="navbarResponsive"
                aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

    </div>
</nav>

<div class="container" id="UserGroupManagement" style="display: none">
    <br/>
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading" style="text-align: center;" align="center">
                <h3>User Group Management</h3>
            </div>
            <br/>
            <div class="panel-body">
                <table class="table table-condensed" id="userGroupTable">
                    <thead>
                    <tr>
                        <th>User Group Name</th>
                        <th>User Group Status</th>
                        <th>User Group Description</th>
                        <th>Users Count</th>
                        <th><span class="fas fa-user-plus fa-w-18 fa-lg fa-fw" data-toggle="modal"
                                  data-target="#AddUserGroupModal" data-backdrop="static" data-keyboard="false">
											</span></th>
                        <th></th>
                    </tr>
                    </thead>

                    <tbody id="userGroupTableBody">
                    </tbody>
                </table>
            </div>

        </div>

    </div>
</div>

<div class="container" id="LogManagement" style="display: none">
    <br/>
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading" style="text-align: center;" align="center">
                <h3>Log Viewer</h3>
            </div>
            <br/>
             <div class="panel-body">
                <span style="display: inline-block; width: 72px;"> Username :  </span>
                        <input type="text" id="searchUsername" Name="searchUsername" style="width: 180px;"/> &nbsp;&nbsp;
                        
                        <span style="display: inline-block; width: 72px;"> From Date : </span>
                        <input type="Date" id="searchByFromDateValue" Name="searchByFromDateValue"
                               style="width: 180px;"/>&nbsp;&nbsp;
                        
                        <span style="display: inline-block; width: 72px;"> To Date :  </span>
                        <input type="Date" id="searchByToDateValue" Name="searchByToDateValue"
                               style="width: 180px;"/>&nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="button" class="btn btn-primary" onclick="submitEventSearch();">Search</button>
                        
            </div>
            
            <div class="panel-body">
                <table class="table table-condensed" id="userGroupTable">
                    <thead>
                    <tr>
                        <th>Event Id</th>
                        <th>Event Description</th>
                        <th>Event Date</th>
                        <th>User Name</th>
                    </tr>
                    </thead>
                    <tbody id="logViewerTableBody">
                    <tr></tr>
                    
                    </tbody>
                    
                </table>
            </div>

        </div>

    </div>
</div>

<!-- Add User Start -->
<div class="modal fade" id="AddUserModal" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Add User
                    Details</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
							<span style="display: inline-block; width: 75px">User Name
								: </span> <input type="text" id="addUserName"/> </br>
                    </br> <span style="display: inline-block; width: 75px">User
								Status : </span> <select name="addUserStatus" id="addUserStatus">
                    <option value="IN">Active</option>
                    <option value="InActive">InActive</option>

                </select> </br>
                    </br> <span style="display: inline-block; width: 75px">User
								Group : </span> <input type="text" id="addUserGroup"/> </br>
                    </br> <span style="display: inline-block; width: 75px">PIN : </span> <input
                        type="text" id="addUserPin"/></br>
                    </br> <span style="display: inline-block; width: 75px">Confirm
								PIN : </span> <input type="text" id="addConfirmPin"/> </br>
                    </br>
                </p>
            </div>
            <div id="addUserResponse"
                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
            <div class="modal-footer">

                <button type="button" class="btn btn-secondary"
                        data-dismiss="modal" onclick="removeMessages(),getAllUserGroups()">Close
                </button>
                <button type="button" class="btn btn-primary"
                        onclick="addUserDetails()">save
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Add User End -->

<!-- Edit User Start -->
<div class="modal fade" id="EditUserModal" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit User
                    Details</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
							<span style="display: inline-block; width: 75px">User Name
								: </span> <input type="text" id="editUserName"/> </br>
                    </br> <span style="display: inline-block; width: 75px">User
								Status : </span> <select name="editUserStatus" id="editUserStatus">
                    <option value="IN">Active</option>
                    <option value="InActive">InActive</option>

                </select> </br>
                    </br> <span style="display: inline-block; width: 75px">User
								Group : </span> <input type="text" id="editUserGroup"/> </br>
                    </br> <span style="display: inline-block; width: 75px">PIN : </span> <input
                        type="text" id="editUserPin"/></br>
                    </br> <span style="display: inline-block; width: 75px">Confirm
								PIN : </span> <input type="text" id="editConfirmPin"/> </br>
                    </br>
                </p>
            </div>
            <div id="editUserResponse"
                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
            <div class="modal-footer">
                <input type="hidden" id="editUserId"/>
                <button type="button" class="btn btn-secondary"
                        data-dismiss="modal" onclick="removeMessages(),getAllUserGroups()">Close
                </button>
                <button type="button" class="btn btn-primary"
                        onclick="updateUserDetails()">update
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Edit User End -->

<!-- Add User Start -->
<div class="modal fade" id="stampModal" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="example4ModalLabel">Add Stamp
                    Details</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <br> <span style="display: inline-block; width: 75px">Stamp Status : </span>
                <select name="addStampStatus" id="addStampStatus">
                    <option value="APPROVED">Approved</option>
                    <option value="REJECTED">Rejected</option>
                </select>
                <br>
                <br>
                <label class="radio-inline">
                    <input type="radio" id="stampFirstPage" name="pagePreference" value="first"> First Page
                </label>
                <label class="radio-inline">
                    <input type="radio" id="stampLastPage" name="pagePreference" value="last"> Last Page
                </label>
                <label class="radio-inline">
                    <input type="radio" id="stampAllPage" name="pagePreference" value="allPages"> All Pages
                </label>
                <br>

            </div>
            <div id="addStampResponse"
                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
            <div class="modal-footer">

                <button type="button" class="btn btn-secondary"
                        data-dismiss="modal" onclick="removeMessages(),refreshFile()">Close
                </button>
                <button type="button" class="btn btn-primary"
                        onclick="addStampDetails()">Stamp
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Add User End -->

<!-- User Page Start -->

<div class="container" id="UserContainer"
     style="max-width: 100%; width: 100%; height: 100%; padding: 10px; display: none;">
    <div style="border: 1px solid #dee2e6; padding: 15px; margin:10px;">
        <table id="masterTable1" style="border: 1px solid #dee2e6; width: 100%; height: 100%;padding: 15px; ">
            <tbody>
            <tr style="height: 35px;">
                <td style="width: 100%; border: 1px solid #dee2e6; vertical-align: top;">
                    <div style="height: 35px; color:white; background-color: #3e3e3e">
                        <table style="width: 100%; height: 100%">
                            <tbody>
                            <tr style="font-size: 14px; font-weight:600; text-align: center;">
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6;">USER NAME
                                </td>
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6;">USER GROUP
                                </td>
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6;">STATUS</td>
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6; padding-left: 5px;">
                                    EDIT / DELETE
                                    &nbsp;
                                    <span class=" fa-grip-lines-vertical"></span>
                                    &nbsp;
                                    <span class="fas fa-user-plus fa-w-18 fa-lg fa-fw" data-toggle="modal"
                                          data-target="#AddUserModal" data-backdrop="static" data-keyboard="false">
											</span>
                                    <!-- <img src="assets/add-user-male-25.png" data-toggle="modal"
                                    data-target="#AddUserModalfas" data-backdrop="static"
                                    data-keyboard="false" /> -->
                                </td>
                            </tr>
                            </tbody>

                        </table>
                    </div>

                </td>
            </tr>
            <tr>
                <td style="width: 100%; border: 1px solid #dee2e6; vertical-align: top; font-size: 14px;  padding: 1px;">
                    <div style="position: relative; height: 800px; overflow-y: auto; overflow-x: auto;">
                        <table id="userDetailsTable" style="width: 100%; position: absolute;">
                            <tbody>
                            <tr>
                                <td style="width: 25%; vertical-align: top; text-align: center;">Username</td>
                                <td style="width: 25%; vertical-align: top; text-align: center;">User Group</td>
                                <td style="width: 25%; vertical-align: top; text-align: center;">Status</td>
                                <td style="width: 25%; vertical-align: top; text-align: center;">Edit / Delete</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>
            </tbody>

        </table>
    </div>
</div>
<!-- User Page End -->
<!-- User Group Page Start -->
<div class="container" id="UserGroupContainer"
     style="max-width: 100%; width: 100%; height: 100%; padding: 10px; display: none;">
    <div style="border: 1px solid #dee2e6; padding: 15px; margin:10px;">
        <table id="masterTable2" style="border: 1px solid #dee2e6; width: 100%; height: 100%;padding: 15px; ">
            <tbody>
            <tr style="height: 35px;">
                <td style="width: 100%; border: 1px solid #dee2e6; vertical-align: top;">
                    <div style="height: 35px; color:white; background-color: #3e3e3e">
                        <table style="width: 100%; height: 100%">
                            <tbody>
                            <tr style="font-size: 14px; font-weight:600; text-align: center;">
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6;">USER GROUP
                                    NAME
                                </td>
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6;">STATUS</td>
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6;">USER GROUP
                                    DESCRIPTION
                                </td>
                                <td style="width: 25%; vertical-align: middle; border: 1px solid #dee2e6; padding-left: 5px;">
                                    EDIT / DELETE
                                    &nbsp;
                                    <span class="fas fa-grip-lines-vertical"></span>
                                    &nbsp;
                                    <span class="fas fa-user-plus fa-w-18 fa-lg fa-fw" data-toggle="modal"
                                          data-target="#AddUserGroupModal" data-backdrop="static" data-keyboard="false">
											</span>
                                    <!-- <img src="assets/add-user-male-25.png" data-toggle="modal"
                                    data-target="#AddUserModal" data-backdrop="static"
                                    data-keyboard="false" /> -->
                                </td>
                            </tr>
                            </tbody>

                        </table>
                    </div>

                </td>
            </tr>
            <tr>
                <td style="width: 100%; border: 1px solid #dee2e6; vertical-align: top; font-size: 14px;  padding: 1px;">
                    <div style="position: relative; height: 800px; overflow-y: auto; overflow-x: auto;">
                        <table id="userGroupsTable" style="width: 100%; position: absolute;">
                            <tbody>

                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>
            </tbody>

        </table>
    </div>
</div>
<!-- Add User Start -->
<div class="modal fade" id="AddUserGroupModal" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel1">Add User Groups</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
							<span style="display: inline-block; width: 110px">User Group Name
								: </span> <input type="text" id="addUserGroupName"/> </br>
                    </br> <span style="display: inline-block; width: 110px">User
								Status : </span> <select name="addUserStatus" id="addUserGroupStatus">
                    <option value="IN">Active</option>
                    <option value="InActive">InActive</option>

                </select> </br>
                    </br> <span style="display: inline-block; width: 110px">User
								Group Description: </span> <input type="text" id="addUserGroupDescription"/> </br>
                    </br>
                </p>
            </div>
            <div id="addUserGroupResponse"
                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
            <div class="modal-footer">

                <button type="button" class="btn btn-secondary"
                        data-dismiss="modal" onclick="removeMessages(),listUserGroups()">Close
                </button>
                <button type="button" class="btn btn-primary"
                        onclick="addUserGroupDetails()">save
                </button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="EditUserGroupModal" tabindex="-1" role="dialog"
     aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel2">Edit User
                    Details</h5>
                <button type="button" class="close" data-dismiss="modal"
                        aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
							<span style="display: inline-block; width: 110px">User Group Name
								: </span> <input type="text" id="editUserGroupName"/> </br>
                    </br> <span style="display: inline-block; width: 75px">User Group
								Status : </span> <select name="editUserGroupStatus" id="editUserGroupStatus">
                    <option value="IN">Active</option>
                    <option value="InActive">InActive</option>

                </select> </br>
                    </br> <span style="display: inline-block; width: 75px">User
								Group Description: </span> <input type="text" id="editUserGroupDescription"/> </br>
                    </br>
                </p>
            </div>
            <div id="editUserGroupResponse"
                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
            <div class="modal-footer">
                <input type="hidden" id="editUserGroupId"/>
                <button type="button" class="btn btn-secondary"
                        data-dismiss="modal" onclick="removeMessages(),listUserGroups()">Close
                </button>
                <button type="button" class="btn btn-primary"
                        onclick="updateUserGroupDetails()">update
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Add User End -->
<!-- User Group Page End -->

<div class="modal fade" id="checkinModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="checkinModalLabel">Check In File</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
                    <span>File Name : </span> <input type="file" id="myCheckinFile" name="filename">
                </p>
                <p>
                <div id="selectedCheckinFile"></div>
                </p>
            </div>
            <div id='checkInloader'
                 style="font-size: 18px; color: #0062cc; font-weight: bold; padding-left: 20px; display: none;">
                Loading <img src='assets/dots.gif' width='80px' height='50px'>
            </div>
            <div id="checkInResponse"
                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal"
                        onclick="removeMessages()">Close
                </button>
                <button type="button" class="btn btn-primary" id="checkInFileButton" onclick="checkin()">
                    CheckIn
                </button>
            </div>
        </div>
    </div>
</div>


<!-- Body Container Start -->
<div class="container" id="DocContainer" style="max-width: 100%; width: 100%; height: 100%; padding: 15px;">
    <table id="masterTable" style="border: 1px solid #dee2e6; width: 100%; height: 100%;">
        <tbody>
        <tr>
            <!--  Folder Browser Start -->
            <td style="width: 15%; border: 2px solid #dee2e6; vertical-align: top; position: relative;">
                <div style="height: 100%;">
                    <!--  Folder Browser Header Menu Start -->
                    <div style="text-align:center;padding-top: 10px; min-width: 284px; height: 42px; background-color: #f0f0f0;border-bottom: 2px solid #dee2e6;">
                        <table style="width: 100%">
                            <thead>
                            <tr style="vertical-align: top;">
                                <th style="background-color: #f0f0f0">
                                    &nbsp;
                                    <a href=#><i class="fas fa-folder fa-w-16 fa-lg fa-fw" style="color:black"
                                                 alt="Folder Browser" title="Folder Browser"
                                                 onclick="listFolder(),refreshPage(),clearSearchTypes();"></i>
                                        <!-- <img src="assets/listDocument.png" alt="Folder Browser" title="Folder Browser" onclick="listFolder();" /> -->
                                    </a>
                                    &nbsp;
                                    <img src="assets/separator.png"/>
                                    &nbsp;
                                    <a href=#><i class="fas fa-folder-plus fa-w-16 fa-lg fa-fw" style="color:black"
                                                 alt="Add Folder" title="Add Folder" data-toggle="modal"
                                                 data-target="#FolerModal" data-backdrop="static"
                                                 data-keyboard="false"></i>
                                        <!-- <img src="assets/addFolder.png" alt="Add Folder" title="Add Folder" data-toggle="modal" data-target="#FolerModal" data-backdrop="static" data-keyboard="false" />  -->
                                    </a>
                                    &nbsp;
                                    <img src="assets/separator.png"/>
                                    &nbsp;
                                    <a href=#><i class="fas fa-upload fa-w-16 fa-lg fa-fw" style="color:black"
                                                 alt="Upload File" title="Upload File" data-toggle="modal"
                                                 data-target="#FileModal" data-backdrop="static"
                                                 data-keyboard="false"></i>
                                        <!-- <img src="assets/upload.png" alt="Upload File" title="Upload File" data-toggle="modal" data-target="#FileModal" data-backdrop="static" data-keyboard="false" /> -->
                                    </a>
                                    &nbsp;
                                    <img src="assets/separator.png"/>
                                    &nbsp;
                                    <a href=#><i class="fas fa-search fa-w-16 fa-lg fa-fw" style="color:black"
                                                 alt="Search File" title="Search File"
                                                 onclick="searchFile(),refreshPage();"></i>
                                        <!-- <img src="assets/search.png" alt="Search File" title="Search File" onclick="searchFile();" /> -->
                                    </a>

                                    <img src="assets/separator.png"/>
                                    &nbsp;
                                    <a href=#><i class="fas fa-bookmark fa-w-16 fa-lg fa-fw" style="color:black"
                                                 alt="Bookmarks" title="Bookmarks"
                                                 onclick="clearPage(),refreshPage(),listBookMarks();"></i>
                                        <!-- <img src="assets/search.png" alt="Search File" title="Search File" onclick="searchFile();" /> -->
                                    </a>

                                    <img src="assets/separator.png"/>
                                    &nbsp;
                                    <a href=#><i class="fas fa-cart-arrow-down fa-w-16 fa-lg fa-fw" style="color:black"
                                                 alt="Checkout Dashboard" title="Checkout Dashboard"
                                                 onclick="clearPage(),refreshPage(),listCheckoutFiles();"></i>
                                        <!-- <img src="assets/search.png" alt="Search File" title="Search File" onclick="searchFile();" /> -->
                                    </a>

                                </th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                    <!--  Folder Browser Header Menu End -->

                    <!--  Folder Browser Tree View Start -->
                    <div id="treeTableDiv"
                         style="overflow-y: auto; overflow-x: auto; max-width: 100%; max-height: 100%; width: auto; height: auto; position: absolute; top: 40px; bottom: 0; left: 0; right: 0; margin: auto;">
                        <table id="treeHierarchyTable" class="table"></table>
                    </div>
                    <!--  Folder Browser Tree View End  -->

                    <!--  Folder Browser Search Option Start  -->
                    <div id="searchFileDiv" style="white-space: nowrap; padding: 10px; display: none;">
                        <span style="display: inline-block; width: 72px;"> File Content  </span>
                        <input type="text" id="searchFileText" Name="searchFileText" style="width: 180px;"/>
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;"> File Property  </span>
                        <input type="text" id="searchFileParamValue" Name="searchFileParamValue" style="width: 180px;"/>
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;"> File Name  </span>
                        <input type="text" id="searchFileNameValue" Name="searchFileNameValue" style="width: 180px;"/>
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;"> Folder Name  </span>
                        <select style="width: 180px;" id="searchFolderNameValue" Name="searchFolderNameValue">
                        </select>
                        <!--                        <input type="text" id="searchFolderNameValue" Name="searchFolderNameValue"-->
                        <!--                               style="width: 180px;"/>-->
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;"> File Date  </span>
                        <input type="Date" id="searchByFileDate1Value" Name="searchByFileDate1Value"
                               style="width: 180px;"/>
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;">  </span>
                        <input type="Date" id="searchByFileDate2Value" Name="searchByFileDate2Value"
                               style="width: 180px;"/>
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;"> Created Date  </span>
                        <input type="Date" id="searchByCreatedDate1Value" Name="searchByCreatedDate1Value"
                               style="width: 180px;"/>
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;">  </span>
                        <input type="Date" id="searchByCreatedDate2Value" Name="searchByCreatedDate2Value"
                               style="width: 180px;"/>
                        <br/>
                        <br/>
                        <br/>
                        <span style="display: inline-block; width: 72px;">
								</span>
                        <input type="checkbox" id="checkWholeWordValue" Name="checkWholeWordValue"/> Whole Word
                        <br/>
                        <br/>
                        <button type="button" class="btn btn-primary" onclick="submitSearch();">Search</button>
                    </div>
                    <!--  Folder Browser Search Option End  -->
                </div>
            </td>
            <!--  Folder Browser End -->
            <td style="width: 0.3%; vertical-align: top; position: relative; background-color: #f0f0f0;">

            </td>
            <!-- <td style="width: 1px;><div style="width: 1px; border: 1px"></div></td> -->
            <!--  File Browser Header Menu Start -->
            <td style="width: 41%; border: 2px solid #dee2e6; vertical-align: top;">
                <div style="height: 100%;">
                    <table id="documentTable" class="table" style="height: 100%;">
                        <!--  File Browser Header Menu Start -->
                        <thead>
                        <tr style="vertical-align: top;">
                            <th style="padding: 10px; text-align:left; min-width: 434px; height: 40px; background-color: #f0f0f0">
                                &nbsp;
                                <a href="#" id="refreshFile" onclick="refreshFile();">
                                    <i class="fas fa-sync-alt fa-w-16 fa-lg fa-fw" style="color:black" alt="Refresh"
                                       title="Refresh"></i>
                                </a>
                                <!-- <img src="assets/refresh.png" alt="Refresh" title="Refresh"/></a> -->
                                &nbsp;
                                <img src="assets/separator.png"/>
                                &nbsp;
                                <a th:href="@{|/downloadFile?fileName=|}" id="downloadActualFile"
                                   onclick="validateDownloadFile(event);">
                                    <i class="fas fa-download fa-w-16 fa-lg fa-fw" style="color:black"
                                       alt="Download File" title="Download File"></i>
                                </a>
                                <!-- <img src="assets/download.png" alt="Download File" title="Download File"/></a>  -->
                                &nbsp;
                                <img src="assets/separator.png"/>
                                &nbsp;
                                <a th:href="@{|/downloadFile?fileName=|}" id="downloadPdfFile"
                                   onclick="validateDownloadPDFFile(event);">
                                    <i class="far fa-file-pdf fa-w-16 fa-lg fa-fw" style="color:black"
                                       alt="Download File As PDF" title="Download File AS PDF"></i>
                                    <!-- <img src="assets/downloadAsPdf.png" alt="Download File As PDF" title="Download File AS PDF" /></a> -->
                                </a>
                                &nbsp;
                                <img src="assets/separator.png"/>
                                &nbsp;
                                <a href=#><i class="fas fa-copy fa-w-16 fa-lg fa-fw" style="color:black"
                                             alt="Split Pdf File" title="Split Pdf File" data-toggle='modal'
                                             onclick="splitFile();"></i>
                                    <!-- <img src="assets/splitFile.png" alt="Split Pdf File" title="Split Pdf File" data-toggle='modal' onclick="splitFile();" /> -->
                                </a>
                                </a>
                                &nbsp;
                                <img src="assets/separator.png"/>
                                &nbsp;
                                <a href=#><i class="far fa-object-ungroup fa-w-16 fa-lg fa-fw" style="color:black"
                                             alt="Merge Pdf Filee" title="Merge Pdf Files"
                                             onclick="mergePdfFiles2()"></i></a>
                                <!-- <img src='assets/merge-documents-30.png' alt="Merge Pdf Filee" title="Merge Pdf Files"  /></a> -->
                                &nbsp;
                                <img src="assets/separator.png"/>
                                &nbsp;
                                <a href=#><i class="far fa-trash-alt fa-w-16 fa-lg fa-fw" alt="Delete File"
                                             style="color:black" title="Delete File" onclick="deleteFile();"></i>
                                    <!-- <img src="assets/delete.png" alt="Delete File" title="Delete File" onclick="deleteFile();" /> -->
                                </a>
                                &nbsp;
                                <img src="assets/separator.png"/>
                                &nbsp;
                                <a href=#><i class="fas fa-print fa-w-16 fa-lg fa-fw" style="color:black"
                                             alt="Print File" title="Print File" onclick="printFile();"></i>
                                    <!-- <img src="assets/print.png" alt="Print File" title="Print File" onclick="printFile();" /> -->
                                </a>

                                <img src="assets/separator.png"/>
                                &nbsp;
                                <a href=#><i class="fas fa-stamp fa-w-16 fa-lg fa-fw" style="color:black"
                                             alt="Stamp File" title="Stamp PDF File" onclick="stampFileCheck();"></i>
                                </a>

                                <span id="shownDocuments" style="float: right; padding: 0px;"> </span></th>
                        </tr>
                        </thead>
                        <!--  File Browser Header Menu End -->

                        <!--  File Browser Table Start -->
                        <tr id="documentDetailsTr" style="vertical-align: top;height: 80%;">
                            <td style="padding: 0rem;">
                                <div id="documentDetails"
                                     style="display: none; overflow-y: auto; overflow-x: auto; white-space: nowrap; height: 100%;">
                                    <table id="fileTable" class="table">
                                    </table>
                                </div>
                            </td>
                        </tr>
                        <!--  File Browser Table End -->

                        <!--  Edit File Details Start -->
                        <tr id="fileDetailsTr" style="vertical-align: top;">
                            <td style="padding: 0rem;">
                                <div class="container" style="height: 100%;overflow: scroll;">
                                    <ul class="nav nav-tabs"
                                        style="overflow: hidden;background-color: #f1f1f1;font-size: medium;">
                                        <li class="nav-item" style="overflow: hidden; border: 1px solid #ccc;">
                                            <a class="nav-link active" data-toggle="tab"
                                               href="#properties">Properties</a>
                                        </li>
                                        <li class="nav-item" style="overflow: hidden;border: 1px solid #ccc;">
                                            <a class="nav-link" data-toggle="tab" href="#versions">Versions</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content" style="height: 100%;">
                                        <div id="properties" class="tab-pane container active">
                                            <div id="fileDetails"
                                                 style="display: none; overflow-y: auto; overflow-x: auto; white-space: nowrap;height: 100%">
                                            </div>
                                            <div id="fileDetailsD">
                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">File Name : </span>
                                                    <span>
								        			<input type="text" id="editFileName"/>
													<input type="hidden" id="editFileId"/>
												</span>
                                                </div>

                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">Keyword 1 : </span>
                                                    <span><input type="text" id="fileSearchParam1"/> </span>
                                                </div>

                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">Keyword 2 : </span>
                                                    <span><input type="text" id="fileSearchParam2"/></span>
                                                </div>

                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">Keyword 3 : </span>
                                                    <span><input type="text" id="fileSearchParam3"/> </span>
                                                </div>

                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">Upload Date : </span>
                                                    <span><input type="text" id="createdDate2"/></span>
                                                </div>

                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">File Date : </span>
                                                    <span><label id="createdDate"></label> </span>
                                                </div>

                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">File Size : </span>
                                                    <span><label id="docSize"></label> </span>
                                                </div>

                                                <div style="padding: .5rem;">
                                                    <span style="display: inline-block;width:100px;">Folder : </span>
                                                    <span><label id="folderNamePath"></label> </span>
                                                </div>


                                                <div id="editFileResponse"
                                                     style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>

                                                <div class='modal-footer' style="padding: 5px 15px 5px 0px;">
                                                    <!-- <button type="button" class="btn btn-secondary" onclick="cancelFileDetailsPopup()">Cancel</button>  -->
                                                    <button type="button" class="btn btn-primary"
                                                            onclick="updateFileName()">
                                                        update
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="versions" class="tab-pane container fade">
                                            <table id="versionTable" class="table table-hover" >
                                                <thead style="background-color: #47a7e3;font-size: small;">
                                                <tr>
                                                    <th>User</th>
                                                    <th>Event</th>
                                                    <th>File Name</th>
                                                    <th>Version</th>
                                                    <th>Date</th>
                                                    <th>Permalink</th>
                                                </tr>
                                                </thead>
                                                <tbody id="versionTableBody">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <!--  Edit File Details End -->
                    </table>
                </div>

                <!--  Add Folder Option Pop up Start -->
                <div class="modal fade" id="FolerModal" tabindex="-1"
                     role="dialog" aria-labelledby="exampleModalLabel"
                     aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Add Folder</h5>
                                <button type="button" class="close" data-dismiss="modal"
                                        aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p>
                                    <span>Folder Name : </span> <input type="text"
                                                                       id="newFolderName"/>
                                </p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary"
                                        data-dismiss="modal" onclick="removeMessages()">Close
                                </button>
                                <button type="button" class="btn btn-primary"
                                        onclick="createFolder()">Add
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--  Add Folder Option Pop up End -->

                <!--  Edit Folder Option Pop up Start -->
                <div class="modal fade" id="EditFolerModal" tabindex="-1" role="dialog"
                     aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Edit Folder Name</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p>
                                    <span>Folder Name : </span>
                                    <input type="text" id="editFolderName"/>
                                    <input type="hidden" id="editFolderId"/>
                                </p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                        onclick="removeMessages()">Close
                                </button>
                                <button type="button" class="btn btn-primary" onclick="updateFolder()">update</button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--  Edit Folder Option Pop up Start -->

                <!--  Split File Option Pop up Start -->
                <div class="modal fade" id="splitFileModal" tabindex="-1"
                     role="dialog" aria-labelledby="exampleModalLabel"
                     aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Split File
                                    :</h5>
                                <button type="button" class="close" data-dismiss="modal"
                                        aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p>
                                    <span>File Name : </span> <span id="splitFileName"> </span>
                                </p>
                                <p>
                                    <span> Range From : </span> <input type="text"
                                                                       id="splitRangeFrom"/> To : <input type="text"
                                                                                                         id="splitRangeTo"/>
                                    <input type="hidden" id="splitFileId"/>
                                </p>
                                <p>
                                    <span> New file name : </span> <input type="text"
                                                                          id="newFileName"/>
                                </p>
                            </div>
                            <div id='splitFileLoader'
                                 style="font-size: 18px; color: #0062cc; font-weight: bold; padding-left: 20px; display: none;">
                                Loading <img src='assets/dots.gif' width='80px' height='50px'>
                            </div>

                            <div id="splitFileResponse"
                                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary"
                                        data-dismiss="modal" onclick="removeMessages()">Close
                                </button>
                                <button type="button" class="btn btn-primary"
                                        onclick="splitFileJS()">split
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--  Split File Option Pop up End -->

                <!--  Merge File Option Pop up Start -->
                <div class="modal fade" id="FileMergeModal" tabindex="-1" role="dialog"
                     aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static"
                     data-keyboard="false">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Merge PDF File</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p>
                                    <span>File Name : </span> <input type="file" id="mergeFileId" name="filename"
                                                                     multiple>
                                </p>
                                <p>
                                <div id="selectedFilesMerge"></div>
                                </p>
                            </div>
                            <div id='mergeLoader'
                                 style="font-size: 18px; color: #0062cc; font-weight: bold; padding-left: 20px; display: none;">
                                Loading <img src='assets/dots.gif' width='80px' height='50px'>
                            </div>
                            <input type="hidden" id="selectedFileId"/>
                            <div id="mergeFileResponse"
                                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                        onclick="removeMessages()">Close
                                </button>
                                <button type="button" class="btn btn-primary" id="uploadFileButton"
                                        onclick="mergePdfFiles()">Merge
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--  Merge File Option Pop up End -->

                <!--  Upload File Option Pop up Start -->
                <div class="modal fade" id="FileModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                     aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Upload File</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <p>
                                    <span>File Name : </span> <input type="file" id="myFile" name="filename" multiple>
                                </p>
                                <p>
                                <div id="selectedFiles"></div>
                                </p>
                            </div>
                            <div id='loader'
                                 style="font-size: 18px; color: #0062cc; font-weight: bold; padding-left: 20px; display: none;">
                                Loading <img src='assets/dots.gif' width='80px' height='50px'>
                            </div>
                            <div id="uploadResponse"
                                 style="font-size: 18px; color: red; font-weight: bold; padding-left: 20px;"></div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                        onclick="removeMessages()">Close
                                </button>
                                <button type="button" class="btn btn-primary" id="uploadFileButton" onclick="addFile()">
                                    Add
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!--  Upload File Option Pop up End -->
            </td>

            <!--  PDF Viewer Container Start -->
            <td style="width: 40%; vertical-align: top; border: 2px solid #dee2e6;">
                <table id="PDF" class="table" style="height: 100%">
                    <!--  PDF Viewer Header Start -->
                    <thead>
                    <tr style="vertical-align: top">
                        <th style="vertical-align: middle;min-width: 523px; padding: .50rem; background-color: #f0f0f0; text-align: center; border: 1px solid #dee2e6; height: 40px; border-bottom: 2px solid #dee2e6;">
                            PDF Viewer
                        </th>
                    </tr>
                    </thead>
                    <!--  PDF Viewer Header End -->

                    <!--  PDF Viewer Start -->
                    <tr>
                        <td style="height: 100%">
                            <iframe id="showPDF" scrolling="yes" src="" style="width: 100%; height: 100%;"></iframe>
                        </td>
                    </tr>
                    <!--  PDF Viewer End -->
                </table>
            </td>
            <!--  PDF Viewer Container End -->

        </tr>
        </tbody>
    </table>
</div>
<!-- Body Container End -->


<!-- Right Click Menu Start -->
<!-- this is the context menu -->
<!-- note the string to=0 where the 0 is the digit to be replaced -->
<div id="div-context-menu" class="cls-context-menu">
    <ul style="width: 148px;">
        <li style="height: 28px;border: 0px;"><a onclick="performCutCopy('cut')">Cut</a></li>
        <li style="height: 28px;border: 0px;"><a onclick="performCutCopy('copy')">Copy </a></li>
        <li style="height: 28px;border: 0px;"><a onclick="changeFileName()">Edit </a></li>
        <li style="height: 28px;border: 0px;" id="addbookmarkli"><a onclick="addBookMark()">Add Bookmark </a></li>
        <li style="height: 28px;border: 0px;" id="removebookmarkli"><a onclick="removeBookMark()">Delete Bookmark </a>
        <li style="height: 28px;border: 0px;" id="checkout"><a onclick="checkout()">Checkout </a></li>
        <li style="height: 28px;border: 0px;" id="checkin">
            <a href=#  alt="Checkin File" title="Checkin File" data-toggle="modal"
                         data-target="#checkinModal" data-backdrop="static"
                         data-keyboard="false">
             Checkin </a>
        </li>
        <!-- <li><a onclick="editFileName()">Edit</a></li> -->
    </ul>
</div>

<div id="div-context-menu-paste" class="pcls-context-menu">
    <ul style="width: 148px;">
        <li style="height: 28px;border: 0px;"><a onclick="performPaste()">Paste </a></li>
        <li style="height: 28px;border: 0px;"><a data-toggle='modal' data-target='#EditFolerModal'
                                                 data-backdrop='static' data-keyboard='false'
                                                 onclick="changeFoldername()">Edit </a></li>
        <li style="height: 28px;border: 0px;"><a onclick="eraseFolder()"> Delete </a></li>

    </ul>
</div>
<!-- Right Click Menu End -->

</body>


<script type="text/javascript">


    (function () {
        var trows = document.getElementById('fileTable').rows,
            t = trows.length,
            trow,
            nextrow,
            addEvent = (function () {
                return window.addEventListener ? function (el, ev, f) {
                    el.addEventListener(ev, f, false); //modern browsers
                } : window.attachEvent ? function (el, ev, f) {
                    el.attachEvent('on' + ev, function (e) {
                        f.apply(el, [e]);
                    }); //IE 8 and less
                } : function () {
                    return;
                }; //a very old browser (IE 4 or less, or Mozilla, others, before Netscape 6), so let's skip those
            })();

        while (--t > -1) {
            trow = trows[t];
            trow.className = 'normal';
            addEvent(trow, 'click', highlightRow);
        }//end while

        function highlightRow(gethighlight) { //now dual use - either set or get the highlighted row
            gethighlight = gethighlight === true;
            var t = trows.length;
            while (--t > -1) {
                trow = trows[t];
                if (gethighlight && trow.className === 'highlighted') {
                    return t;
                } else if (!gethighlight && trow !== this) {
                    trow.className = 'normal';
                }
            }//end while

            return gethighlight ? null : this.className = this.className === 'highlighted' ? 'normal' : 'highlighted';
        }//end function


        function movehighlight(way, e) {
            e.preventDefault && e.preventDefault();
            e.returnValue = false;
            var idx = highlightRow(true); //gets current index or null if none highlighted


            if (typeof idx === 'number') {//there was a highlighted row
                idx += way; //increment\decrement the index value

                if (idx > -1 && (nextrow = trows[idx])) {
                    nextrow = trows[idx];

                    var tdInRow = nextrow.getElementsByTagName('td');
                    jQuery('#' + tdInRow[2].id).trigger('click');
                    return highlightRow.apply(nextrow);

                } //index is > 0 and a row exists at that index

                else if (idx > 0) {
                    return highlightRow.apply(trows[0]);

                } //index is out of range high, go to first row
                return highlightRow.apply(trows[trows.length - 1]);

                //index is out of range low, go to last row
            }

            return highlightRow.apply(trows[way > 0 ? 0 : trows.length - 1]); //none was highlighted - go to 1st if down arrow, last if up arrow


        }//end function


        function processkey(e) {
            switch (e.keyCode) {
                case 38: {//up arrow
                    return movehighlight(-1, e);
                }
                case 40: {//down arrow
                    return movehighlight(1, e);
                }
                default: {
                    return true;
                }
            }
        }//end function

        addEvent(document, 'keydown', processkey);

    })();


    function formatBytes(bytes, decimals = 3) {
        if (bytes === 0) return '0 Bytes';

        const k = 1024;
        const dm = decimals < 0 ? 0 : decimals;
        const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];

        const i = Math.floor(Math.log(bytes) / Math.log(k));

        return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
    }


    /** Cut Copy - Right Click Option Start**/
    function performCutCopy(action) {
        localStorage.setItem("selectedFileIdAction", action);
    }

    function removeBookMark() {
        if (localStorage.getItem("selectedFileIdForBookmark") != null) {

            var fileId = localStorage.getItem("selectedFileIdForBookmark");

            $.ajax({
                url: '/deleteBookmark?fileId=' + fileId,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function () {
                    alert("File successfully removed from Bookmark");
                    location.reload();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        }
    }

    function addBookMark() {
        if (localStorage.getItem("selectedFileIdForBookmark") != null) {

            var fileId = localStorage.getItem("selectedFileIdForBookmark");

            $.ajax({
                url: '/addBookmark?fileId=' + fileId,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function () {
                    alert("File successfully Added to Bookmark");
                    //location.reload();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        }
    }

    function checkin() {
            if (localStorage.getItem("selectedFileIdForBookmark") != null) {

                var fileId = localStorage.getItem("selectedFileIdForBookmark");

                document.getElementById('checkInResponse').innerHTML = "";

                var formData = new FormData();
                if (storedFiles.length > 0) {
                    document.getElementById('checkInFileButton').disabled = true;
                    $("#loader").show();
                    for (var i = 0, len = storedFiles.length; i < len; i++) {
                        formData.append('file', storedFiles[i]);
                    }

                    formData.append('fileId', fileId);
                    var xhr = new XMLHttpRequest();

                    // Open the connection
                    xhr.open('POST', '/checkin', true);

                    // Set up a handler for when the task for the request is complete
                    xhr.onload = function () {
                        if (xhr.status == 200) {
                            document.getElementById('checkInResponse').innerHTML = "<p style='padding-left:10px; color:green'>Checkin Complete</p>";
                            storedFiles = [];
                            document.getElementById("selectedFiles").innerHTML = "";
                            document.getElementById("myCheckinFile").value = "";
                            document.getElementById('checkInFileButton').disabled = false;
                            $("#loader").hide();
                        } else {
                            var err = JSON.parse(xhr.responseText);
                            alert(err.message);
                            if (err.message.includes("Session Expired")) {
                                window.location.href = "/login";
                            } else {
                                document.getElementById('checkInResponse').innerHTML = "<p>Checkin error. Try again.</p>";
                                $("#loader").hide();
                                alert("Checkin error. Try again.");
                                document.getElementById('checkInFileButton').disabled = false;
                            }

                        }
                    };

                    // Send the data.
                    xhr.send(formData);


                } else {
                    alert("Please choose the file to checkin");
                }
            }
    }

    function checkout() {
        if (localStorage.getItem("selectedFileIdForBookmark") != null) {

            var fileId = localStorage.getItem("selectedFileIdForBookmark");

            $.ajax({
                url: '/checkout?fileId=' + fileId,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function () {
                    alert("File successfully Checked out.");
                    //location.reload();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        }
    }

    function changeFoldername() {

        if (localStorage.getItem("selectedFolderIdForPaste") != null
            && localStorage.getItem("selectedFolderIdForPaste") != ""
            && localStorage.getItem("selectedFolderNameForPaste") != null
            && localStorage.getItem("selectedFolderNameForPaste") != "") {

            var folderId = localStorage.getItem("selectedFolderIdForPaste");
            var folderName = localStorage.getItem("selectedFolderNameForPaste");

            document.getElementById('editFolderName').value = decodeURIComponent(folderName);
            document.getElementById('editFolderId').value = folderId;

        }
    }

    function changeFileName() {

        if (localStorage.getItem("selectedFileIdForCutCopy") != null
            && localStorage.getItem("selectedFileIdForCutCopy") != "") {

            var fileId = localStorage.getItem("selectedFileIdForCutCopy");
            var id = "#cutCopyId_" + fileId;
            var funcName = $(id).attr('onClick').replaceAll("'", "");
            var nameArray = funcName.split("(");
            var args = nameArray[1].replace(")", "");
            var argsArray = args.split(",");
            editFileName(argsArray[0], argsArray[1], argsArray[2], argsArray[3], argsArray[4], argsArray[5], argsArray[6], argsArray[7]);

        }

    }

    function eraseFolder() {
        if (localStorage.getItem("selectedFolderIdForPaste") != null
            && localStorage.getItem("selectedFolderIdForPaste") != "") {
            var folderId = localStorage.getItem("selectedFolderIdForPaste");
            var result = confirm("Want to delete?");
            if (result) {
                $.ajax({
                    url: '/deleteFolder?folderId=' + folderId,
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (data) {
                        alert("Folder Deleted");
                        location.reload();
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        }
                    }
                });
            }
        }
    }


    function performPaste() {

        if (localStorage.getItem("selectedFileIdAction") != null
            && localStorage.getItem("selectedFolderIdForPaste") != null
            && localStorage.getItem("selectedFileIdForCutCopy") != null
            && localStorage.getItem("selectedFileIdAction") != ""
            && localStorage.getItem("selectedFolderIdForPaste") != ""
            && localStorage.getItem("selectedFileIdForCutCopy") != "") {

            var fileToCopy = "";
            if (localStorage.getItem("selectedFileId")) {
                fileToCopy = localStorage.getItem("selectedFileId");
            } else {
                fileToCopy = localStorage.getItem("selectedFileIdForCutCopy");
            }

            if (localStorage.getItem("selectedFolderIdForPaste") != '1') {
                $.ajax({
                    url: '/fileOperation?nodeId='
                        + localStorage.getItem("selectedFolderIdForPaste")
                        + "&fileId=" + fileToCopy + "&action="
                        + localStorage.getItem("selectedFileIdAction"),
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function () {
                        alert("File successfully copied");
                        //location.reload();
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        }
                    }
                });

            } else {
                alert("Files can't be copied into default folder");
            }

        } else {
            alert("Please select the file to perform cut/copy/paste of file");
        }

    }

    var rgtClickContextMenu = document.getElementById('div-context-menu');
    var rgtClickPasteContextMenu = document
        .getElementById('div-context-menu-paste');

    /** close the right click context menu on click anywhere else in the page*/
    document.onclick = function (e) {
        rgtClickContextMenu.style.display = 'none';
        rgtClickPasteContextMenu.style.display = 'none';
    }

    document.oncontextmenu = function (e) {

        var elmnt = e.target

        if (elmnt.className.startsWith("pcls-context-menu")) {
            e.preventDefault();
            var eid = elmnt.id.replace(/folderIdForPaste_/, "")

            localStorage.setItem("selectedFolderNameForPaste", elmnt.innerText);
            localStorage.setItem("selectedFolderIdForPaste", eid);
            rgtClickPasteContextMenu.style.left = e.pageX + 'px'
            rgtClickPasteContextMenu.style.top = e.pageY + 'px'
            rgtClickPasteContextMenu.style.display = 'block'

        }
        if (elmnt.className.startsWith("cls-context-menu")) {
            e.preventDefault();
            // console.log("Right click");

            var eid = elmnt.id.replace(/cutCopyId_/, "")
            var bookmarked = isBookmarked(eid);
            // console.log(s);
            if (bookmarked) {
                document.getElementById("addbookmarkli").style.pointerEvents = "none";
                document.getElementById("addbookmarkli").style.opacity = "0.3";
                document.getElementById("removebookmarkli").style.pointerEvents = "all";
                document.getElementById("removebookmarkli").style.opacity = "1.0";
            } else {
                document.getElementById("removebookmarkli").style.pointerEvents = "none";
                document.getElementById("removebookmarkli").style.opacity = "0.3";
                document.getElementById("addbookmarkli").style.pointerEvents = "all";
                document.getElementById("addbookmarkli").style.opacity = "1.0";
            }
            var checkedOut = isCheckedOut(eid);
            // console.log(s);
            if (checkedOut) {
                document.getElementById("checkout").style.pointerEvents = "none";
                document.getElementById("checkout").style.opacity = "0.3";
                document.getElementById("checkin").style.pointerEvents = "all";
                document.getElementById("checkin").style.opacity = "1.0";
            } else {
                document.getElementById("checkin").style.pointerEvents = "none";
                document.getElementById("checkin").style.opacity = "0.3";
                document.getElementById("checkout").style.pointerEvents = "all";
                document.getElementById("checkout").style.opacity = "1.0";
            }
            rgtClickContextMenu.style.left = e.pageX + 'px'
            rgtClickContextMenu.style.top = e.pageY + 'px'
            rgtClickContextMenu.style.display = 'block'
            localStorage.setItem("selectedFileIdForCutCopy", eid);
            localStorage.setItem("selectedFileIdForBookmark", eid);
        }
    }

    function isBookmarked(eid) {
        //console.log(eid);
        if (eid !== null) {
            //var fileId = localStorage.getItem("selectedFileIdForBookmark");
            var returnValue;
            $.ajax({
                async: false,
                url: '/getBookmarkStatus?fileId=' + eid,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    //console.log(data.message);
                    if (data.message === 'Bookmark Present') {
                        returnValue = true;
                    } else {
                        returnValue = false;
                    }
                },
                error: function (xhr, status, error) {
                    returnValue = false;
                }
            });
            return returnValue;
        }
    }

    function isCheckedOut(eid) {
        //console.log(eid);
        if (eid !== null) {
            //var fileId = localStorage.getItem("selectedFileIdForBookmark");
            var returnValue;
            $.ajax({
                async: false,
                url: '/getCheckoutStatus?fileId=' + eid,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    //console.log(data.message);
                    if (data.message === 'File checked out') {
                        returnValue = true;
                    } else {
                        returnValue = false;
                    }
                },
                error: function (xhr, status, error) {
                    returnValue = false;
                }
            });
            return returnValue;
        }
    }
</script>

<script>
    /** All User Related Functions Start Here **/

    /** Get All Users Function Start Here **/
    function getAllUsers() {
        $
            .ajax({
                "type": 'get',
                "url": '/getUsers',
                "dataType": "json",
                "success": function (data) {
                    $('#userDetailsTable tr').remove();
                    $
                        .each(
                            data,
                            function (idx, obj) {
                                $("#userDetailsTable")
                                    .append(
                                        "<tr style='height:30px; overflow-y: auto; overflow-x: auto;'><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                        + obj.userName
                                        + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                        + obj.userGroup
                                        + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                        + obj.empcurrentStatus
                                        + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>&nbsp;<img src='assets/edit.png' data-toggle='modal' data-target='#EditUserModal' data-backdrop='static' data-keyboard='false' onclick=editUserDetails("
                                        + "'"
                                        + encodeURIComponent(obj.userName)
                                        + "','"
                                        + encodeURIComponent(obj.userGroup)
                                        + "','"
                                        + encodeURIComponent(obj.empcurrentStatus)
                                        + "','"
                                        + encodeURIComponent(obj.loginId)
                                        + "','"
                                        + encodeURIComponent(obj.passCode)
                                        + "') id=userId_"
                                        + obj.loginId
                                        + ">&nbsp;&nbsp;<img src='assets/remove.png' onclick=deleteUserProfile('"
                                        + obj.loginId
                                        + "')></td></tr>");
                            });
                }
            });
    }
    /** Get All Users Function End Here **/
    
     /** Get All Events Function Starts Here **/
    
    function getAllEvents() {
        $
            .ajax({
                "type": 'get',
                "url": '/getAllEvents',
                "dataType": "json",
                "success": function (data) {
                    $('#logViewerTableBody tr').remove();
                    $
                        .each(
                            data,
                            function (idx, obj) {
                                $("#logViewerTableBody")
                                    .append(
                                        "<tr style='height:30px; overflow-y: auto; overflow-x: auto;'><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                        + obj.eventId
                                        + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                        + obj.eventDesc
                                        + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                        + obj.eventDate
                                        + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                        +obj.userName
                                        +"</td></tr>");
                            });
                }
            });
    }


    /** Get All Events Function End Here **/
    
    /** Search Events Function starts Here **/
     function submitEventSearch() {
    	
    	 var username = document.getElementById("searchUsername").value;
    	 var fileDate1 = document.getElementById("searchByFromDateValue").value;
         var fileDate2 = document.getElementById("searchByToDateValue").value;
         if ((fileDate1 == null || fileDate2 == null || username =="")) {
             alert("Please enter all the fields for the search");
         }else{
        	 $.ajax({
                 "type": 'get',
                 "url": '/searchAllEvents?username='+username+"&fromDate="+fileDate1+"&toDate="+fileDate2,
                 "dataType": "json",
                 "success": function (data) {
                     $('#logViewerTableBody tr').remove();
                     $
                         .each(
                             data,
                             function (idx, obj) {
                                 $("#logViewerTableBody")
                                     .append(
                                         "<tr style='height:30px; overflow-y: auto; overflow-x: auto;'><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                         + obj.eventId
                                         + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                         + obj.eventDesc
                                         + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                         + obj.eventDate
                                         + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                         +obj.userName
                                         +"</td></tr>");
                             });
                 }
             });
         }
         
        
    }

     /** Search Events Function Ends Here **/

    /** Add User Details Function Start Here **/
    function addUserDetails() {
        userName = document.getElementById('addUserName').value;
        status = document.getElementById("addUserStatus").value;
        userGroup = document.getElementById('addUserGroup').value;
        pin = document.getElementById('addUserPin').value;
        confPin = document.getElementById('addConfirmPin').value;
        if (userName != '' && status != '' && userGroup != '' && pin != ''
            && pin == confPin) {
            if (pin.length == 4 && !isNaN(pin)) {
                $
                    .ajax({
                        url: '/addUserDetails?userName=' + userName
                            + "&status=" + status + "&userGroup="
                            + userGroup + "&pin=" + pin,
                        type: 'post',
                        dataType: 'json',
                        contentType: 'application/json',
                        success: function (data) {
                            document.getElementById('addUserResponse').innerHTML = "<p style='padding-left:10px; color:green'>User details got added!</p>";
                            document.getElementById('addUserName').value = "";
                            document.getElementById("addUserStatus").value = "Active";
                            document.getElementById('addUserGroup').value = "";
                            document.getElementById('addUserPin').value = "";
                            document.getElementById('addConfirmPin').value = "";

                        },
                        error: function (xhr, status, error) {
                            var err = JSON.parse(xhr.responseText);
                            alert(err.message);
                            if (err.message.includes("Session Expired")) {
                                window.location.href = "/login";
                            }
                        }
                    });
            } else {
                alert("Please verify and provide valid Pin");
            }
        } else {
            alert("Please verify and provide valid details");
        }
    }

    /** Add User Details Function End Here **/

    /** Get All UserGroups Function Start Here **/
    function getAllUserGroups1() {
        $
            .ajax({
                "type": 'get',
                "url": '/usergroup',
                "dataType": "json",
                "success": function (data) {
                    $('#userGroupsTable tr').remove();
                    $.each(
                        data,
                        function (idx, obj) {
                            $("#userGroupsTable")
                                .append(
                                    "<tr style='height:30px; overflow-y: auto; overflow-x: auto;'><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                    + obj.groupName
                                    + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                    + obj.groupStatus
                                    + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>"
                                    + obj.groupDescription
                                    + "</td><td style='width: 25%;border: 1px solid #dee2e6;padding-left: 10px;'>&nbsp;<img src='assets/edit.png' data-toggle='modal' data-target='#EditUserGroupModal' data-backdrop='static' data-keyboard='false' onclick=editUserGroupDetails("
                                    + "'"
                                    + encodeURIComponent(obj.groupName)
                                    + "','"
                                    + encodeURIComponent(obj.groupStatus)
                                    + "','"
                                    + encodeURIComponent(obj.groupDescription)
                                    + "','"
                                    + encodeURIComponent(obj.groupId)
                                    + "') id=userGroupId_"
                                    + obj.groupId
                                    + ">&nbsp;&nbsp;<img src='assets/remove.png' onclick=deleteUserGroup('"
                                    + obj.groupId
                                    + "')></td></tr>");
                        });
                }
            });
    }

    /** Get All UserGroups Function Start Here **/
    function getAllUserGroups() {
        $
            .ajax({
                "type": 'get',
                "url": '/usergroup',
                "dataType": "json",
                "success": function (data) {
                    loadUserGroupData(data);
                }
            });
    }

    function loadUserGroupData(items) {
        const table = document.getElementById("userGroupTableBody");
        table.innerHTML = '';
        items.forEach(item => {
            let row = table.insertRow();
            row.setAttribute("class", "accordion-toggle");
            row.setAttribute("data-toggle", "collapse");
            row.setAttribute("data-target", "#" + item.groupId);
            let userGroupName = row.insertCell(0);
            userGroupName.innerHTML = item.groupName;
            let status = row.insertCell(1);
            status.innerHTML = item.groupStatus;
            let desc = row.insertCell(2);
            desc.innerHTML = item.groupDescription;
            let userCount = row.insertCell(3);
            userCount.innerHTML = item.userList.length;
            let viewButton = row.insertCell(4);
            viewButton.innerHTML = '<button class="btn btn-default btn-xs"><span class="fas fa-eye"></span></button>';
            let editButton = row.insertCell(5);
            editButton.innerHTML = '<button class="btn btn-default btn-xs" data-toggle="modal" data-target="#EditUserGroupModal" data-backdrop="static"' +
                ' data-keyboard="false" ><span class="fas fa-pen"></span></button>';
            editButton.onclick = function () {
                editUserGroupDetails(encodeURIComponent(item.groupName), encodeURIComponent(item.groupStatus),
                    encodeURIComponent(item.groupDescription), encodeURIComponent(item.groupId))
            };
            let hiddenRow = table.insertRow();
            let usersRowHolder = hiddenRow.insertCell(0);
            usersRowHolder.setAttribute("colspan", "12");
            usersRowHolder.setAttribute("class", "hiddenRow");
            let divElement = document.createElement('div');
            divElement.setAttribute("class", "accordian-body collapse");
            divElement.setAttribute("id", item.groupId);
            let tbl = document.createElement('table');
            tbl.setAttribute("class", "table");
            let userTableHead = tbl.createTHead();
            let headRow = userTableHead.insertRow(0);
            headRow.setAttribute("class", "info");
            let userNameHeader = headRow.insertCell(0);
            userNameHeader.innerHTML = "User Name";
            let statusHeader = headRow.insertCell(1);
            statusHeader.innerHTML = "Status";
            let empty = headRow.insertCell(2);
            empty.innerHTML = '<button class="btn btn-default btn-xs" data-toggle="modal" data-target="#AddUserModal" data-backdrop="static"' +
                ' data-keyboard="false" ><span class="fas fa-user-plus"></span></button>';
            let userTableBody = tbl.createTBody();
            //userTableBody.setAttribute("id","userTableBody");
            divElement.appendChild(tbl);
            usersRowHolder.appendChild(divElement);
            item.userList.forEach(user => {
                let row1 = userTableBody.insertRow(0);
                let userName1 = row1.insertCell(0);
                userName1.innerHTML = user.userName;
                let status1 = row1.insertCell(1);
                status1.innerHTML = user.empcurrentStatus;
                let editButton1 = row1.insertCell(2);
                editButton1.innerHTML = '<button class="btn btn-default btn-xs" data-toggle="modal" data-target="#EditUserModal" data-backdrop="static"' +
                    ' data-keyboard="false" ><span class="fas fa-pen"></span></button>';
                editButton1.onclick = function () {
                    editUserDetails(encodeURIComponent(user.userName), encodeURIComponent(user.userGroup),
                        encodeURIComponent(user.empcurrentStatus), encodeURIComponent(user.loginId), encodeURIComponent(user.passCode));
                };
            });
        });
    }

    /** Get All UserGroups Function End Here **/

    /** Add User Group Details Function Start Here **/
    function addUserGroupDetails() {
        userGroupName = document.getElementById('addUserGroupName').value;
        userGroupStatus = document.getElementById("addUserGroupStatus").value;
        userGroupDescription = document.getElementById('addUserGroupDescription').value;
        if (userGroupName != '' && userGroupStatus != '' && userGroupDescription != '') {

            $.ajax({
                url: '/usergroup?userGroupName=' + userGroupName
                    + "&userGroupStatus=" + userGroupStatus + "&userGroupDescription="
                    + userGroupDescription,
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    document.getElementById('addUserGroupResponse').innerHTML = "<p style='padding-left:10px; color:green'>User Group got added!</p>";
                    document.getElementById('addUserGroupName').value = "";
                    document.getElementById("addUserGroupStatus").value = "IN";
                    document.getElementById('addUserGroupDescription').value = "";
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });

        } else {
            alert("Please verify and provide valid details");
        }
    }

    /** Add User Details Function End Here **/

    function editUserDetails(userName, userGroup, status, loginId, pin) {
        document.getElementById('editUserName').value = decodeURIComponent(userName);
        document.getElementById("editUserStatus").value = status;
        document.getElementById('editUserGroup').value = decodeURIComponent(userGroup);
        document.getElementById('editUserPin').value = decodeURIComponent(pin);
        document.getElementById('editConfirmPin').value = decodeURIComponent(pin);
        document.getElementById('editUserId').value = decodeURIComponent(loginId);
    }

    function editUserGroupDetails(userGroupName, userGroupStatus, userGroupDescription, userGroupId) {
        document.getElementById('editUserGroupName').value = decodeURIComponent(userGroupName);
        document.getElementById("editUserGroupStatus").value = decodeURIComponent(userGroupStatus);
        document.getElementById('editUserGroupDescription').value = decodeURIComponent(userGroupDescription);
        document.getElementById('editUserGroupId').value = decodeURIComponent(userGroupId);
    }

    /** Update User Details Function Start Here **/
    function updateUserDetails() {
        userName = document.getElementById('editUserName').value;
        status = document.getElementById("editUserStatus").value;
        userGroup = document.getElementById('editUserGroup').value;
        pin = document.getElementById('editUserPin').value;
        confPin = document.getElementById('editConfirmPin').value;
        loginId = document.getElementById('editUserId').value;
        if (userName != '' && status != '' && userGroup != '' && pin != ''
            && pin == confPin) {
            if (pin.length == 4 && !isNaN(pin)) {
                $
                    .ajax({
                        url: '/updateUserDetails?loginId=' + loginId
                            + "&userName=" + userName + "&status="
                            + status + "&userGroup=" + userGroup
                            + "&pin=" + pin,
                        type: 'post',
                        dataType: 'json',
                        contentType: 'application/json',
                        success: function (data) {
                            document.getElementById('editUserResponse').innerHTML = "<p style='padding-left:10px; color:red'>User details got updated!</p>";
                        },
                        error: function (xhr, status, error) {
                            var err = JSON.parse(xhr.responseText);
                            alert(err.message);
                            if (err.message.includes("Session Expired")) {
                                window.location.href = "/login";
                            }
                        }
                    });
            } else {
                alert("Please verify and provide valid Pin");
            }
        } else {
            alert("Please verify and provide valid details");
        }
    }

    /** Update User Details Function End Here **/
    function updateUserGroupDetails() {
        userGroupName = document.getElementById('editUserGroupName').value;
        userGroupStatus = document.getElementById("editUserGroupStatus").value;
        userGroupDescription = document.getElementById('editUserGroupDescription').value;
        groupId = document.getElementById('editUserGroupId').value;
        if (userGroupName != '' && userGroupStatus != '' && userGroupDescription != '') {
            $
                .ajax({
                    url: '/usergroup?userGroupName=' + userGroupName
                        + "&userGroupStatus=" + userGroupStatus + "&userGroupDescription="
                        + userGroupDescription + "&userGroupId=" + groupId,
                    type: 'put',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (data) {
                        document.getElementById('editUserGroupResponse').innerHTML = "<p style='padding-left:10px; color:red'>User Group details got updated!</p>";
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        }
                    }
                });
        } else {
            alert("Please verify and provide valid details");
        }
    }

    /** Delete User Function Start Here **/
    function deleteUserProfile(userId) {
        var result = confirm("Want to delete?");
        if (result) {
            $.ajax({
                url: '/deleteUser?userId=' + userId,
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    alert(data.message);
                    listUsers();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        }

    }

    /** Delete User Function End Here **/

    /** All User Related Functions End Here **/

    /** Delete User Function Start Here **/
    function deleteUserGroup(userGroupId) {
        var result = confirm("Want to delete?");
        if (result) {
            $.ajax({
                url: '/usergroup?userGroupId=' + userGroupId,
                type: 'delete',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    alert(data.message);
                    listUserGroups();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        }

    }

    /** Delete User Function End Here **/


</script>

<script>

    /*All Folder Browser Related Function Start Here*/

    /** Onclick Folder Icon Open Tree View Folder Browser - Start Here**/
    function listFolder() {
        document.getElementById("editFileName").value = "";
        document.getElementById('fileSearchParam1').value = "";
        document.getElementById('fileSearchParam2').value = "";
        document.getElementById('fileSearchParam3').value = "";
        document.getElementById('createdDate').value = "";
        document.getElementById('createdDate2').innerText = "";
        document.getElementById("treeTableDiv").style.display = "block";
        document.getElementById("searchFileDiv").style.display = "none";
    }

    function listBookMarks() {
        let fileSize = 0;
        document.getElementById("treeTableDiv").style.display = "none";
        document.getElementById("fileDetails").style.display = "block";
        document.getElementById("documentDetails").style.display = "block";

        $.ajax({
            url: '/getAllBookmarkedFiles',
            type: 'get',
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {

                document.getElementById("shownDocuments").innerHTML = "Shown " + fileSize + " Documents";
                found = false;
                var fileTableHtml = document.getElementById('fileTable');

                $("#fileTable tr").remove();
                $.each(data, function (idx, obj) {
                    fileSize++;

                    if (obj.fileId != null) {
                        found = true;
                        var tr = fileTableHtml.insertRow(-1);
                        document.getElementById("documentDetails").style.display = "block";
                        document.getElementById("documentDetailsTr").style.height = "100%";
                        var td = document.createElement('td');
                        td.innerHTML = "<table style='float:left; width:70%;'><tr class='innerTableRow'> <td style='width:5%; border:0px;'><input type='checkbox' class='checkboxSize' name='selectedFile' id='CheckBox_"
                            + obj.fileId
                            + "' onclick=getFileForCopy('"
                            + obj.filePath
                            + "','"
                            + obj.pdfFilePath
                            + "','"
                            + obj.fileId
                            + "','"
                            + encodeURIComponent(obj.fileName)
                            + "','"
                            + encodeURIComponent(obj.treePath)
                            + "','"
                            + encodeURIComponent(obj.fileSearch1)
                            + "','"
                            + encodeURIComponent(obj.fileSearch2)
                            + "','"
                            + encodeURIComponent(obj.fileSearch3)
                            + "') value='"
                            + obj.fileId
                            + "'/></td><td style='border:0px;' id='cutCopyId_"
                            + obj.fileId
                            + "' class='cls-context-menu-link' onclick=populateVersions('"+obj.fileId+"'),getFileName('"
                            + obj.filePath
                            + "','"
                            + obj.pdfFilePath
                            + "','"
                            + obj.fileId
                            + "','"
                            + encodeURIComponent(obj.fileName)
                            + "','"
                            + encodeURIComponent(obj.treePath)
                            + "','"
                            + encodeURIComponent(obj.fileSearch1)
                            + "','"
                            + encodeURIComponent(obj.fileSearch2)
                            + "','"
                            + encodeURIComponent(obj.fileSearch3)
                            + "');editFileName('"
                            + obj.filePath
                            + "','"
                            + obj.pdfFilePath
                            + "','"
                            + obj.fileId
                            + "','"
                            + encodeURIComponent(obj.fileName)
                            + "','"
                            + encodeURIComponent(obj.treePath)
                            + "','"
                            + encodeURIComponent(obj.fileSearch1)
                            + "','"
                            + encodeURIComponent(obj.fileSearch2)
                            + "','"
                            + encodeURIComponent(obj.fileSearch3)
                            + "','"
                            + encodeURIComponent(obj.createdAt)
                            + "','"
                            + encodeURIComponent(obj.createdOn)
                            + "','"
                            + encodeURIComponent(obj.userNameFd)
                            + "','"
                            + encodeURIComponent(obj.userGroup)
                            + "','"
                            + encodeURIComponent(obj.fileSizeFd)
                            + "')>"
                            + obj.fileName
                            + "</td></tr></table>";

                        var keywords = "";
                        if (obj.fileSearch1) {
                            keywords = obj.fileSearch1
                                + ","
                        }
                        if (obj.fileSearch2) {
                            keywords = keywords
                                + obj.fileSearch2
                                + ","
                        }

                        if (obj.fileSearch3) {
                            keywords = keywords
                                + obj.fileSearch3
                                + ","
                        }
                        if (keywords) {
                            keywords = keywords
                                .slice(0, -1)
                        }
                        td.innerHTML = td.innerHTML
                            + "<span style='float:right'>"
                            + keywords
                            + "&nbsp; | &nbsp;"
                            + obj.createdAt
                            + "</span>";
                        td.innerHTML = td.innerHTML
                            + "<span style='float:right'>"
                            + keywords
                            + "&nbsp; | &nbsp;"
                            + obj.currentVersion
                            + "</span>";
                        tr.appendChild(td);

                    }
                });
                if (!found) {
                    document.getElementById("addFolderDiv").style.display = "none";
                }
                document.getElementById("shownDocuments").innerHTML = "Shown "
                    + fileSize + " Documents";
            },
            error: function (error) {
                console.log(`Error ${error}`);
            }
        });
    }
    function populateVersions(fileId) {
        document.getElementById('versionTableBody').innerHTML='';
        var versionTableHtml = document.getElementById('versionTableBody');

       // $("#versionTable tr").remove();
        if(fileId!=null){
            $.ajax({
                url: '/getAllVersions?fileId='+fileId,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    //console.log(data);
                    $.each(data, function (idx, obj) {
                        //console.log(obj);
                        var tr = versionTableHtml.insertRow(-1);
                        //User
                        var user = document.createElement('td');
                        user.innerHTML=obj.userName;
                        tr.appendChild(user);
                        //Version comment/event
                        var event = document.createElement('td');
                        event.innerHTML=obj.versionComment;
                        tr.appendChild(event);
                        //File Name
                        var fileName = document.createElement('td');
                        fileName.innerHTML=obj.fileDetails.fileName;
                        tr.appendChild(fileName);
                        //Version
                        var version = document.createElement('td');
                        version.innerHTML=obj.fileVersion;
                        tr.appendChild(version);
                        //Creation Date
                        var date = document.createElement('td');
                        date.innerHTML=new Date(obj.createdAt).toUTCString();
                        tr.appendChild(date);
                        //Download Link
                        var downloadLink = document.createElement('td');
                        let path='/downloadFile?filePath='+obj.filePath+'&fileId='+obj.fileDetails.fileId+
                            '&pdfFile=no&version='+obj.fileVersion;
                        downloadLink.innerHTML="<a href='"+path+"'>Download</a>";
                        tr.appendChild(downloadLink);
                    });
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                },
            });
        }

    }
    function listCheckoutFiles() {
        let fileSize = 0;
        document.getElementById("treeTableDiv").style.display = "none";
        document.getElementById("fileDetails").style.display = "block";
        document.getElementById("documentDetails").style.display = "block";

        $.ajax({
            url: '/getAllCheckedOutFiles',
            type: 'get',
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {

                document.getElementById("shownDocuments").innerHTML = "Shown " + fileSize + " Documents";
                found = false;
                var fileTableHtml = document.getElementById('fileTable');

                $("#fileTable tr").remove();
                $.each(data, function (idx, obj) {
                    fileSize++;

                    if (obj.fileId != null) {
                        found = true;
                        var tr = fileTableHtml.insertRow(-1);
                        document.getElementById("documentDetails").style.display = "block";
                        document.getElementById("documentDetailsTr").style.height = "100%";
                        var td = document.createElement('td');
                        td.innerHTML = "<table style='float:left; width:70%;'><tr class='innerTableRow'> <td style='width:5%; border:0px;'><input type='checkbox' class='checkboxSize' name='selectedFile' id='CheckBox_"
                            + obj.fileId
                            + "' onclick=getFileForCopy('"
                            + obj.filePath
                            + "','"
                            + obj.pdfFilePath
                            + "','"
                            + obj.fileId
                            + "','"
                            + encodeURIComponent(obj.fileName)
                            + "','"
                            + encodeURIComponent(obj.treePath)
                            + "','"
                            + encodeURIComponent(obj.fileSearch1)
                            + "','"
                            + encodeURIComponent(obj.fileSearch2)
                            + "','"
                            + encodeURIComponent(obj.fileSearch3)
                            + "') value='"
                            + obj.fileId
                            + "'/></td><td style='border:0px;' id='cutCopyId_"
                            + obj.fileId
                            + "' class='cls-context-menu-link' onclick=populateVersions('"+obj.fileId+"'),getFileName('"
                            + obj.filePath
                            + "','"
                            + obj.pdfFilePath
                            + "','"
                            + obj.fileId
                            + "','"
                            + encodeURIComponent(obj.fileName)
                            + "','"
                            + encodeURIComponent(obj.treePath)
                            + "','"
                            + encodeURIComponent(obj.fileSearch1)
                            + "','"
                            + encodeURIComponent(obj.fileSearch2)
                            + "','"
                            + encodeURIComponent(obj.fileSearch3)
                            + "');editFileName('"
                            + obj.filePath
                            + "','"
                            + obj.pdfFilePath
                            + "','"
                            + obj.fileId
                            + "','"
                            + encodeURIComponent(obj.fileName)
                            + "','"
                            + encodeURIComponent(obj.treePath)
                            + "','"
                            + encodeURIComponent(obj.fileSearch1)
                            + "','"
                            + encodeURIComponent(obj.fileSearch2)
                            + "','"
                            + encodeURIComponent(obj.fileSearch3)
                            + "','"
                            + encodeURIComponent(obj.createdAt)
                            + "','"
                            + encodeURIComponent(obj.createdOn)
                            + "','"
                            + encodeURIComponent(obj.userNameFd)
                            + "','"
                            + encodeURIComponent(obj.userGroup)
                            + "','"
                            + encodeURIComponent(obj.fileSizeFd)
                            + "')>"
                            + obj.fileName
                            + "</td></tr></table>";

                        var keywords = "";
                        if (obj.fileSearch1) {
                            keywords = obj.fileSearch1
                                + ","
                        }
                        if (obj.fileSearch2) {
                            keywords = keywords
                                + obj.fileSearch2
                                + ","
                        }

                        if (obj.fileSearch3) {
                            keywords = keywords
                                + obj.fileSearch3
                                + ","
                        }
                        if (keywords) {
                            keywords = keywords
                                .slice(0, -1)
                        }
                        td.innerHTML = td.innerHTML
                            + "<span style='float:right'>"
                            + keywords
                            + "&nbsp; | &nbsp;"
                            + obj.createdAt
                        "</span>";
                        td.innerHTML = td.innerHTML
                            + "<span style='float:right'>"
                            + keywords
                            + "&nbsp; | &nbsp;"
                            + obj.currentVersion
                            + "</span>";
                        tr.appendChild(td);

                    }
                });
                if (!found) {
                    document.getElementById("addFolderDiv").style.display = "none";
                }
                document.getElementById("shownDocuments").innerHTML = "Shown "
                    + fileSize + " Documents";
            },
            error: function (error) {
                console.log(`Error ${error}`);
            }
        });
    }

    function clearPage() {
        document.getElementById("treeTableDiv").style.display = "none";
        document.getElementById("searchFileDiv").style.display = "none";
    }


    /** Onclick Folder Icon Open Tree View Folder Browser - End Here**/

    /** Add Folder Function Start Here**/
    function createFolder() {
        if (document.getElementById("newFolderName").value != "") {
            var newFolderData = {
                "parentId": localStorage.getItem("selectedNode"),
                "folderName": document.getElementById("newFolderName").value
            }

            $.ajax({
                url: '/addFolderName',
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    alert(`Data ${data.message}`);
                    location.reload();
                    $("#treeHierarchyTable").expandNode("treeView7");
                    //location.reload();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                },
                data: JSON.stringify(newFolderData)
            });
        }
    }

    /** Add Folder Function End Here**/

    /** Upload File Function Start Here **/
    function addFile() {

        document.getElementById('uploadResponse').innerHTML = "";

        var formData = new FormData();
        if (storedFiles.length > 0) {
            document.getElementById('uploadFileButton').disabled = true;
            $("#loader").show();
            for (var i = 0, len = storedFiles.length; i < len; i++) {
                formData.append('files', storedFiles[i]);
            }
            //formData.append('file', file);
            if (localStorage.getItem("selectedNode") != '1') {
                formData.append('nodeId', localStorage.getItem("selectedNode"));
                var xhr = new XMLHttpRequest();

                // Open the connection
                xhr.open('POST', '/upload', true);

                // Set up a handler for when the task for the request is complete
                xhr.onload = function () {
                    if (xhr.status == 200) {
                        document.getElementById('uploadResponse').innerHTML = "<p style='padding-left:10px; color:green'>Upload completed!</p>";

                        //$('#FileModal').modal('hide');
                        //$('body').removeClass('modal-open');
                        //$('body').css('padding-right', '0px');
                        //$('.modal-backdrop').remove();
                        storedFiles = [];
                        document.getElementById("selectedFiles").innerHTML = "";
                        document.getElementById("myFile").value = "";
                        document.getElementById('uploadFileButton').disabled = false;
                        $("#loader").hide();
                    } else {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        } else {
                            document.getElementById('uploadResponse').innerHTML = "<p>Upload error. Try again.</p>";
                            $("#loader").hide();
                            alert("Upload error. Try again.");
                            document.getElementById('uploadFileButton').disabled = false;
                        }

                    }
                };

                // Send the data.
                xhr.send(formData);

            } else {

                alert("Files can't be loaded into default folder");
                $("#loader").hide();
                document.getElementById('uploadFileButton').disabled = false;
            }
        } else {
            alert("Please choose the file to upload");
        }

    }

    /** Upload File Function End Here **/
   
    /** Search Page Change Start Here **/
    /** Onclick Search Icon Changes Folder Browser to Search Container **/
    function searchFile() {
        document.getElementById("editFileName").value = "";
        document.getElementById('fileSearchParam1').value = "";
        document.getElementById('fileSearchParam2').value = "";
        document.getElementById('fileSearchParam3').value = "";
        document.getElementById('folderNamePath').value = "";
        document.getElementById('createdDate').value = "";
        document.getElementById('docSize').value = "";
        document.getElementById('createdDate2').innerText = "";
        document.getElementById("treeTableDiv").style.display = "none";
        document.getElementById("searchFileDiv").style.display = "block";
        var selectId = document.getElementById('searchFolderNameValue');
        if (selectId.options.length == 0) {
            $(selectId).append('<option></option>');
            $.ajax({
                url: '/getAllFolders',
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    for (var i in data) {
                        var pathValue = data[i].folderPath.substring(1, data[i].folderPath.length - 1).replaceAll(" ", "-");
                        $(selectId).append('<option value=' + pathValue + '>' + data[i].folderPath.substring(1, data[i].folderPath.length - 1) + '</option>');
                    }
                }
            });
        }
    }

    /** Search Page Change Start Here **/
    
    /** Search File Function Start Here **/
    function submitSearch() {
        let fileSize = 0;
        document.getElementById("treeTableDiv").style.display = "none";
        document.getElementById("fileDetails").style.display = "none";
        var searchParam = document.getElementById("searchFileText").value;
        var fileSearchParam = document.getElementById("searchFileParamValue").value;
        var fileNameParam = document.getElementById("searchFileNameValue").value;
        var folderPathParam = document.getElementById("searchFolderNameValue").value;
        var fileDate1 = document.getElementById("searchByFileDate1Value").value;
        var fileDate2 = document.getElementById("searchByFileDate2Value").value;
        var creationDate1 = document.getElementById("searchByCreatedDate1Value").value;
        var creationDate2 = document.getElementById("searchByCreatedDate2Value").value;
        var wholeWord = document.getElementById("checkWholeWordValue").checked;
        console.log(folderPathParam);

        document.getElementById("fileDetails").style.display = "block";
        document.getElementById("documentDetails").style.display = "block";

        /* $("#fileDetails div").remove();
        document.getElementById("documentDetailsTr").style.height = "80%";
        document.getElementById("fileDetailsTr").style.height = "20%";
        $("#fileDetails")
        .append("<div style='padding: .5rem;'><span style='display: inline-block;width:70px;'>File Name : </span><span><input type='text' id='editFileName' /> <input type='hidden' id='editFileId' /></span></div>")
        .append("<div style='padding: .5rem;'><span style='display: inline-block;width:70px;'>Keyword 1 : </span><span><input type='text' id='fileSearchParam1' /> </span></div>")
        .append("<div style='padding: .5rem;'><span style='display: inline-block;width:70px;'>Keyword 2 : </span><span><input type='text' id='fileSearchParam2' /> </span></div>")
        .append("<div style='padding: .5rem;'><span style='display: inline-block;width:70px;'>Keyword 3 : </span><span><input type='text' id='fileSearchParam3' /> </span></div>")
        .append("<div id='editFileResponse' style='font-size: 18px; color: red; font-weight: bold; padding-left: 20px;'></div>")
        .append("<div class='modal-footer'> <button type='button' class='btn btn-secondary' onclick='cancelFileDetailsPopup()''>Cancel</button> <button type='button' class='btn btn-primary' onclick='updateFileName()''>update</button></div>");
         */
        if ((fileNameParam == null || fileNameParam == "") && (searchParam == null || searchParam == "") && (fileSearchParam == null || fileSearchParam == "")) {
            alert("Please mention File Name (or) File Content (or) property to search");
        } else if ((fileDate1 == "" && fileDate2 !== "") || (fileDate1 !== "" && fileDate2 == "")) {
            alert("Please pass both start and end file dates");
        } else if ((creationDate1 == "" && creationDate2 !== "") || (creationDate1 !== "" && creationDate2 == "")) {
            alert("Please pass both start and end creation dates");
        } else {
            $.ajax({
                url: '/searchFolder?searchParam=' + searchParam + "&fileNameSearch=" + fileNameParam + "&fileSearch=" + fileSearchParam +
                    "&folderSearch=" + folderPathParam + "&fileDate1=" + fileDate1 + "&fileDate2=" + fileDate2 + "&creationDate1=" + creationDate1 +
                    "&creationDate2=" + creationDate2 + "&W=" + wholeWord,
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {

                    document.getElementById("shownDocuments").innerHTML = "Shown " + fileSize + " Documents";
                    found = false;
                    var fileTableHtml = document.getElementById('fileTable');

                    $("#fileTable tr").remove();
                    $.each(data, function (idx, obj) {
                        fileSize++;

                        if (obj.fileId != null) {
                            found = true;
                            var tr = fileTableHtml.insertRow(-1);
                            document.getElementById("documentDetails").style.display = "block";
                            document.getElementById("documentDetailsTr").style.height = "100%";
                            var td = document.createElement('td');
                            td.innerHTML = "<table style='float:left; width:70%;'><tr class='innerTableRow'> <td style='width:5%; border:0px;'><input type='checkbox' class='checkboxSize' name='selectedFile' id='CheckBox_"
                                + obj.fileId
                                + "' onclick=getFileForCopy('"
                                + obj.filePath
                                + "','"
                                + obj.pdfFilePath
                                + "','"
                                + obj.fileId
                                + "','"
                                + encodeURIComponent(obj.fileName)
                                + "','"
                                + encodeURIComponent(obj.treePath)
                                + "','"
                                + encodeURIComponent(obj.fileSearch1)
                                + "','"
                                + encodeURIComponent(obj.fileSearch2)
                                + "','"
                                + encodeURIComponent(obj.fileSearch3)
                                + "') value='"
                                + obj.fileId
                                + "'/></td><td style='border:0px;' id='cutCopyId_"
                                + obj.fileId
                                + "' class='cls-context-menu-link' onclick=populateVersions('"+obj.fileId+"'),getFileName('"
                                + obj.filePath
                                + "','"
                                + obj.pdfFilePath
                                + "','"
                                + obj.fileId
                                + "','"
                                + encodeURIComponent(obj.fileName)
                                + "','"
                                + encodeURIComponent(obj.treePath)
                                + "','"
                                + encodeURIComponent(obj.fileSearch1)
                                + "','"
                                + encodeURIComponent(obj.fileSearch2)
                                + "','"
                                + encodeURIComponent(obj.fileSearch3)
                                + "');editFileName('"
                                + obj.filePath
                                + "','"
                                + obj.pdfFilePath
                                + "','"
                                + obj.fileId
                                + "','"
                                + encodeURIComponent(obj.fileName)
                                + "','"
                                + encodeURIComponent(obj.treePath)
                                + "','"
                                + encodeURIComponent(obj.fileSearch1)
                                + "','"
                                + encodeURIComponent(obj.fileSearch2)
                                + "','"
                                + encodeURIComponent(obj.fileSearch3)
                                + "','"
                                + encodeURIComponent(obj.createdAt)
                                + "','"
                                + encodeURIComponent(obj.createdOn)
                                + "','"
                                + encodeURIComponent(obj.userNameFd)
                                + "','"
                                + encodeURIComponent(obj.userGroup)
                                + "','"
                                + encodeURIComponent(obj.fileSizeFd)
                                + "')>"
                                + obj.fileName
                                + "</td></tr></table>";

                            var keywords = "";
                            if (obj.fileSearch1) {
                                keywords = obj.fileSearch1
                                    + ","
                            }
                            if (obj.fileSearch2) {
                                keywords = keywords
                                    + obj.fileSearch2
                                    + ","
                            }

                            if (obj.fileSearch3) {
                                keywords = keywords
                                    + obj.fileSearch3
                                    + ","
                            }
                            if (keywords) {
                                keywords = keywords
                                    .slice(0, -1)
                            }

                            td.innerHTML = td.innerHTML
                                + "<span style='float:right'>"
                                + keywords
                                + "&nbsp; | &nbsp;"
                                + obj.createdAt
                            "</span>";
                            td.innerHTML = td.innerHTML
                                + "<span style='float:right'>"
                                + keywords
                                + "&nbsp; | &nbsp;"
                                + obj.currentVersion
                                + "</span>";
                            tr.appendChild(td);

                        }
                    });
                    if (!found) {
                        document.getElementById("addFolderDiv").style.display = "none";
                    }
                    document.getElementById("shownDocuments").innerHTML = "Shown "
                        + fileSize + " Documents";
                },
                error: function (error) {
                    console.log(`Error ${error}`);
                }
            });
        }

    }

    /** Search File Function End Here **/


    /** Folder Browser Function Start Here**/
    function getAllNodes() {
        $
            .ajax({
                "type": 'get',
                "url": '/nodes',
                "dataType": "json",
                "success": function (data) {
                    $('#treeHierarchyTable tr').remove();
                    $
                        .each(
                            data,
                            function (idx, obj) {
                                $("#treeHierarchyTable")
                                    .append(
                                        "<tr style='border:0px;' onclick=getFileNames('"
                                        + obj.nodeId
                                        + "') data-tt-id=\""
                                        + obj.nodeId
                                        + "\" data-tt-parent-id=\""
                                        + obj.pid
                                        + "\"><td style='border:0px;' id=treeView" + obj.nodeId + "><span class='far fa-folder fa-w-16 fa-lg fa-fw'></span><span style='padding-left:5px' id='folderIdForPaste_" + obj.nodeId
                                        + "' class='pcls-context-menu-link'>"
                                        + obj.text
                                        + "</span>"
                                        /* +"<span style='display: inline-block; float:right;'><img src='assets/edit.png' data-toggle='modal'  data-target='#EditFolerModal' data-backdrop='static'	data-keyboard='false' onclick=editFolder("
                                        + obj.nodeId
                                        + ",'"
                                        + encodeURIComponent(obj.text)
                                        + "') id=\""
                                        + obj.nodeId
                                        + "\"/> &nbsp;<img src='assets/remove.png' onclick=deleteFolder("
                                        + obj.nodeId
                                        + ") id=\""
                                        + obj.nodeId
                                        + "\"/></span>" */
                                        + "</span></td></tr>");
                            });
                    $("#treeHierarchyTable").treetable({
                        expandable: true,
                        scroll: true,
                        clickableNodeNames: true,
                        indent: 5
                    });
                    //$('#treeHierarchyTable').treetable('expandAll');
                    //$('#treeHierarchyTable').treetable('expandNode',7);
                    $("#treeHierarchyTable")
                        .on(
                            "mousedown",
                            "tr",
                            function () {
                                $(".selected").not(this)
                                    .removeClass("selected");
                                $(this).toggleClass("selected");
                                if ($("#treeHierarchyTable tr.selected").length > 0) {
                                    localStorage.setItem(
                                        "selectedNode", $(this)
                                            .data("ttId"));
                                } else {
                                    localStorage.setItem(
                                        "selectedNode", "1");
                                }
                            });
                }
            });
        //$("#treeHierarchyTable").expandNode("treeView7");
        //$('#treeHierarchyTable').treetable('expandNode', 39);
    }

    /** Folder Browser Function End Here**/

    /** Edit Folder Name Function Start Here **/
    function editFolder(folderId, folderName) {
        document.getElementById('editFolderName').value = decodeURIComponent(folderName);
        document.getElementById('editFolderId').value = folderId;

    }

    /** Edit Folder Name Function End Here **/


    /** Update Folder Name Function Start Here **/
    function updateFolder() {
        folderId = document.getElementById('editFolderId').value;
        folderName = document.getElementById('editFolderName').value;
        if (document.getElementById('editFolderName').value != '') {
            $.ajax({
                url: '/updateFolder?folderId=' + folderId + "&folderName="
                    + folderName,
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    alert("Folder Name updated");
                    location.reload();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        }

    }

    /** Update Folder Name Function End Here **/


    /** Delete Folder Function Start Here**/
    function deleteFolder(folderId) {
        /* folderId = document.getElementById('editFolderId').value; */
        var result = confirm("Want to delete?");
        if (result) {
            $.ajax({
                url: '/deleteFolder?folderId=' + folderId,
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    alert("Folder Deleted");
                    location.reload();
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        }

    }

    /** Delete Folder Function End Here **/




    /*All Folder Browser Related Function End Here*/

</script>

<script>


    var table = document.getElementById('masterTable');
    //alert(table);
    resizableGrid(table);


    function resizableGrid(e) {
        var t = e.getElementsByTagName("tr")[0], n = t ? t.children : void 0;
        if (n) {
            e.style.overflow = "hidden";
            for (var i = e.offsetHeight, o = 0; o < n.length; o++) {
                var r = s(i);
                n[o].appendChild(r), n[o].style.position = "relative", d(r)
            }
        }

        function d(e) {
            var t, n, i, o, r;
            e.addEventListener("mousedown", function (e) {
                n = e.target.parentElement, i = n.nextElementSibling,
                    t = e.pageX;
                var d = function (e) {
                    if ("border-box" == l(e, "box-sizing"))
                        return 0;
                    var t = l(e, "padding-left"), n = l(e, "padding-right");
                    return parseInt(t) + parseInt(n)
                }(n);
                o = n.offsetWidth - d, i && (r = i.offsetWidth - d)
            }), e.addEventListener("mouseover", function (e) {
                e.target.style.borderRight = "3px solid #5fbaf2"
            }), e.addEventListener("mouseout", function (e) {
                e.target.style.borderRight = ""
            }), document.addEventListener("mousemove", function (e) {
                if (n) {
                    var d = e.pageX - t;
                    i && (i.style.width = r - d + "px"), n.style.width = o + d
                        + "px"
                }
            }), document.addEventListener("mouseup", function (e) {
                n = void 0, i = void 0, t = void 0, r = void 0, o = void 0
            })
        }

        function s(e) {
            var t = document.createElement("div");
            return t.style.top = 0, t.style.right = 0, t.style.width = "5px",
                t.style.position = "absolute",
                t.style.cursor = "col-resize", t.style.userSelect = "none",
                t.style.height = e + "px", t
        }

        function l(e, t) {
            return window.getComputedStyle(e, null).getPropertyValue(t)
        }
    }


    var selDiv = "";
    var merDiv = "";
    var storedFiles = [];
    var mergeFiles = [];

    $(document).ready(function () {
        localStorage.setItem("selectedNode", "1");
        localStorage.setItem("selectedFileIdForCutCopy", "");
        localStorage.setItem("selectedFolderIdForPaste", "");
        localStorage.setItem("selectedFolderNameForPaste", "");
        document.getElementById("myFile").value = "";
        document.getElementById("myCheckinFile").value = "";
        getAllNodes();
        $("#myFile").on("change", handleFileSelect);
        $("#myCheckinFile").on("change", handleFileSelect);
        selDiv = $("#selectedFiles");
        //$("#myForm").on("submit", handleForm);

        $("body").on("click", ".selFile", removeFile);

        $("#mergeFileId").on("change", handleMergeFileSelect);
        merDiv = $("#selectedFilesMerge");
        $("body").on("click", ".merFile", removeMerFile);
        //$("#myForm").on("submit", handleForm);

    });

    function handleMergeFileSelect(e) {
        var files = e.target.files;
        var filesArr = Array.prototype.slice.call(files);
        filesArr
            .forEach(function (f) {

                mergeFiles.push(f);

                var reader = new FileReader();
                reader.onload = function (e) {
                    var html = "<div><p>"
                        + f.name
                        + " &nbsp;&nbsp;&nbsp;<img src='assets/remove.png' data-file='" + f.name + "' class='merFile' /></p></div>";
                    merDiv.append(html);

                }
                reader.readAsDataURL(f);
            });

    }

    function handleFileSelect(e) {
        var files = e.target.files;
        var filesArr = Array.prototype.slice.call(files);
        filesArr
            .forEach(function (f) {

                storedFiles.push(f);

                var reader = new FileReader();
                reader.onload = function (e) {
                    var html = "<div><p>"
                        + f.name
                        + " &nbsp;&nbsp;&nbsp;<img src='assets/remove.png' data-file='" + f.name + "' class='selFile' /></p></div>";
                    selDiv.append(html);

                }
                reader.readAsDataURL(f);
            });

    }

    function removeMerFile(e) {
        var file = $(this).data("file");
        for (var i = 0; i < mergeFiles.length; i++) {
            if (mergeFiles[i].name === file) {
                mergeFiles.splice(i, 1);
                break;
            }
        }
        $(this).parent().remove();
    }

    function removeFile(e) {
        var file = $(this).data("file");
        for (var i = 0; i < storedFiles.length; i++) {
            if (storedFiles[i].name === file) {
                storedFiles.splice(i, 1);
                break;
            }
        }
        $(this).parent().remove();
    }

    /* Documents icon onClick function changes users container to documents container*/
    function listDocuments() {
        document.getElementById("DocContainer").style.display = "block";
        document.getElementById("UserGroupManagement").style.display = "none";
        document.getElementById("LogManagement").style.display = "none";
        //document.getElementById("UserGroupContainer").style.display = "none";

    }

    /* Users icon onClick changes documents container to users container*/
    // function listUsers() {
    //     document.getElementById("DocContainer").style.display = "none";
    //     document.getElementById("UserGroupManagement").style.display = "block";
    //     document.getElementById("UserGroupContainer").style.display = "none";
    //     //getAllUsers();
    //     getAllUserGroups1();
    //
    // }

    function listUserGroups() {
        document.getElementById("DocContainer").style.display = "none";
        document.getElementById("LogManagement").style.display = "none";
        document.getElementById("UserGroupManagement").style.display = "block";
        //document.getElementById("UserGroupContainer").style.display = "block";
        getAllUserGroups();
    }

    function listLog() {
    	document.getElementById("UserGroupManagement").style.display = "none";
        document.getElementById("DocContainer").style.display = "none";
        document.getElementById("LogManagement").style.display = "block";
        //document.getElementById("UserGroupContainer").style.display = "block";
        getAllEvents();
    }

    
    
    
    
    /** Logout Function Start Here **/
    function logout() {
        $.ajax({
            url: '/logout',
            type: 'post',
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {
                window.location.href = "/login";
            },
            error: function (error) {
                window.location.href = "/login";
            }
        });
    }

    /** Logout Function End Here **/

    function clearSearchTypes() {
        document.getElementById("searchFileText").value = "";
        document.getElementById("searchFileParamValue").value = "";
        document.getElementById("searchFileNameValue").value = "";
    }

    function refreshPage() {
        $('#fileTable td').remove();
        document.getElementById("showPDF").src = "";
        document.getElementById('folderNamePath').innerText = "";
        document.getElementById('docSize').innerText = "";
    }

    /** Refresh File Browser Start Here**/
    function refreshFile() {
        var nodeId = localStorage.getItem("selectedNode");
        getFileNames(nodeId);
        localStorage.setItem("selectedFileId", null);
        document.getElementById("showPDF").src = "";
        $('#fileDetailsD div').remove();
        $('#fileDetails div').remove();
        document.getElementById("fileDetails").style.display = "block";
        document.getElementById("documentDetails").style.display = "block";

        document.getElementById("documentDetailsTr").style.height = "50%";
        document.getElementById("fileDetailsTr").style.height = "50%";
        $("#fileDetails")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>File Name : </span><span><input type='text' id='editFileName' /> <input type='hidden' id='editFileId' /></span></div>")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Keyword 1 : </span><span><input type='text' id='fileSearchParam1' /> </span></div>")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Keyword 2 : </span><span><input type='text' id='fileSearchParam2' /> </span></div>")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Keyword 3 : </span><span><input type='text' id='fileSearchParam3' /> </span></div>")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>File Date : </span><span><input type='date' id='createdDate' value='' /> </span></div>")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Uploaded Date : </span><span><label id='createdDate2'></label> </span></div>")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>File Size : </span><span><label id='docSize'></label> </span></div>")
            .append("<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Folder : </span><span><label id='folderNamePath'></label> </span></div>")
            .append("<div id='editFileResponse' style='font-size: 18px; color: red; font-weight: bold; padding-left: 20px;'></div>")
            .append("<div class='modal-footer' style='padding: 5px 15px 5px 0px;'><button type='button' class='btn btn-primary' onclick='updateFileName()''>update</button></div>");
        /* .append("<div class='modal-footer'> <button type='button' class='btn btn-secondary' onclick='cancelFileDetailsPopup()''>Cancel</button> <button type='button' class='btn btn-primary' onclick='updateFileName()''>update</button></div>"); */

    }

    /** Refresh File Browser End Here**/

    /** Download Raw File Function Start Here**/
    function validateDownloadFile(e) {
        var hrefValue = document.getElementById("downloadActualFile").href;
        if (hrefValue.includes("fileId")) {
            return true;
        } else {
            alert("Please select the file to export as PDF");
            e.preventDefault();
            return false;
        }
    }

    /** Download Raw File Function End Here**/

    /** Download PDF File Function Start Here**/
    function validateDownloadPDFFile(e) {
        var hrefValue = document.getElementById("downloadPdfFile").href;
        if (hrefValue.includes("fileId")) {
            return true;
        } else {
            alert("Please select the file to download");
            e.preventDefault();
            return false;
        }
    }

    /** Download PDF File Function End Here**/

    /** Split File Icon Onclick Function Start Here**/
    /** This function check the file is selected and not more than one file and check the file is pdf only**/
    function splitFile() {
        document.getElementById('splitFileResponse').innerHTML = "";

        if (localStorage.getItem("selectedFileId") != null
            && localStorage.getItem("selectedFileId").indexOf(',') != -1) {
            alert("More than one file has been selected. Please select only one file to Split");
        } else {
            if (localStorage.getItem("selectedFileId") == 'undefined'
                || localStorage.getItem("selectedFileId") == 'null'
                || localStorage.getItem("selectedFileId") == null
                || localStorage.getItem("selectedFileId") == "") {

                alert("Please select the file to Split");
                $('#splitFileModal').modal('hide');
            } else if (!document.getElementById("splitFileName").innerText
                .includes(".pdf")) {
                alert("Please select PDF file to Split");
                $('#splitFileModal').modal('hide');
            } else {
                $('#splitFileModal').modal('show');
            }
        }
    }

    /** Split File Icon Onclick Function End Here**/


    /** Split File Function End Here**/
    function splitFileJS() {
        document.getElementById('splitFileResponse').innerHTML = "";

        var fileName = document.getElementById("splitFileName").innerText;
        if (fileName.includes(".pdf")) {
            $("#splitFileLoader").show();
            if (localStorage.getItem("selectedFileId") != 'undefined'
                && localStorage.getItem("selectedFileId") != 'null'
                && localStorage.getItem("selectedFileId") != null) {

                var formData = new FormData();
                formData.append('nodeId', localStorage.getItem("selectedNode"));
                formData.append('fileId', document
                    .getElementById('splitFileId').value);
                formData.append('newFileName', document
                    .getElementById('newFileName').value);
                formData.append('fromRange', document
                    .getElementById('splitRangeFrom').value);
                formData.append('toRange', document
                    .getElementById('splitRangeTo').value);
                var xhr = new XMLHttpRequest();
                xhr.open('POST', '/splitFile', true);

                xhr.onload = function () {
                    if (xhr.status == 200) {
                        refreshFile();
                        $("#splitFileLoader").hide();

                        if (xhr.responseText.includes("Error occured")) {
                            document.getElementById('splitFileResponse').innerHTML = "<p>Error occurred. Please try again later.</p>";
                        } else {
                            document.getElementById('splitFileResponse').innerHTML = "<p style='padding-left:10px; color:red'>Split Process is copmleted!</p>";

                        }

                        document.getElementById("splitFileId").value = "";
                        document.getElementById("splitRangeFrom").value = "";
                        document.getElementById("splitRangeTo").value = "";


                    } else {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        } else {
                            document.getElementById('splitFileResponse').innerHTML = "<p>Split process error. Try again.</p>";
                        }

                    }
                };

                // Send the data.
                xhr.send(formData);

            } else {
                alert("Please select the file to Split");
                $("#splitFileModal").hide();
                //$('#splitFileModal').modal('hide');
            }
        } else {
            alert("Please select PDF file to Split");
            $("#splitFileModal").hide();
        }

    }

    /** Split File Function End Here**/

    /** Delete File Function Start Here**/
    function deleteFile() {
        if (localStorage.getItem("selectedFileId") != 'undefined'
            && localStorage.getItem("selectedFileId") != 'null'
            && localStorage.getItem("selectedFileId") != null) {
            var result = confirm("Want to delete?");
            if (result) {
                $.ajax({
                    url: '/deleteFile?fileId='
                        + localStorage.getItem("selectedFileId"),
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (data) {
                        refreshFile();
                        if (data.message === 'File Deleted'){
                            alert("File Deleted");
                        }
                        if(data.message === 'Some Files are checked out. Can not be deleted.')
                        {
                            alert("Some Files are checked out. Can not be deleted.")
                        }
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        }
                    }
                });
            }

        } else {
            alert("Please select the file to delete");
        }

    }

    /** Delete File Function End Here**/

    /*Staming Functionality*/

    function stampFileCheck() {

        if (!document.getElementById("splitFileName").innerText
            .includes(".pdf")) {
            alert("Please select PDF file to Stamp");
            $('#stampModal').modal('hide');
        }
        else if (localStorage.getItem("selectedFileId") != 'undefined'
            && localStorage.getItem("selectedFileId") != 'null'
            && localStorage.getItem("selectedFileId") != null) {
            console.log(localStorage.getItem("selectedFileId"));
            $('#stampModal').modal('show');
        }else {
            alert("No files selected");
        }
    }

    function addStampDetails() {
        var stampStatus = document.getElementById('addStampStatus').value;
        var pagePreference;
        if (document.getElementById('stampFirstPage').checked) {
            pagePreference = document.getElementById('stampFirstPage').value;
        } else if (document.getElementById('stampLastPage').checked) {
            pagePreference = document.getElementById('stampLastPage').value;
        } else if (document.getElementById('stampAllPage').checked) {
            pagePreference = document.getElementById('stampAllPage').value;
        }
        $.ajax({
            url: '/stampFile?fileId=' + localStorage.getItem("selectedFileId") + '&stampStatus='
                + stampStatus + '&pagePreference=' + pagePreference,
            type: 'get',
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {
                document.getElementById('addStampResponse').innerHTML = "<p style='padding-left:10px; color:green'>File Stamped</p>";
            },
            error: function (xhr, status, error) {
                var err = JSON.parse(xhr.responseText);
                alert(err.message);
                if (err.message.includes("Session Expired")) {
                    window.location.href = "/login";
                }
            }
        });
    }

    /** Print File Function Start Here**/
    function printFile() {
        if (localStorage.getItem("selectedFileId") != 'undefined'
            && localStorage.getItem("selectedFileId") != 'null'
            && localStorage.getItem("selectedFileId") != null) {
            const params = new URL(
                document.getElementById("downloadPdfFile").href).searchParams;
            var filePath = params.get('filePath')

            $.ajax({
                url: '/printFile?filePath=' + filePath + '&fileId='
                    + localStorage.getItem("selectedFileId"),
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {

                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });

        } else {
            alert("Please select the file to print");
        }

    }

    /** Print File Function End Here**/


    /** Get File Name Function Start Here**/
    function getFileNames(nodeId) {
        document.getElementById('editFileName').value = "";
        document.getElementById('fileSearchParam1').value = "";
        document.getElementById('fileSearchParam2').value = "";
        document.getElementById('fileSearchParam3').value = "";
        document.getElementById('folderNamePath').innerText = "";


        document.getElementById("fileDetails").style.display = "100%";
        document.getElementById("documentDetails").style.height = "100%";
        document.getElementById("documentDetailsTr").style.height = "100%";


        let fileSize = 0;
        $
            .ajax({
                url: '/getFiles?nodeId=' + nodeId,
                type: "get",
                dataType: "json",
                success: function (data) {
                    document.getElementById("shownDocuments").innerHTML = "Shown "
                        + fileSize + " Documents";
                    found = false;
                    var fileTableHtml = document
                        .getElementById('fileTable');
                    $("#fileTable tr").remove();
                    $
                        .each(
                            data,
                            function (idx, obj) {
                                fileSize++;

                                if (obj.fileId != null) {
                                    found = true;
                                    var tr = fileTableHtml
                                        .insertRow(-1);
                                    //document.getElementById("documentDetails").style.height = (Number(screen.height) - Number(336))	+ "px";
                                    document
                                        .getElementById("documentDetails").style.display = "block";

                                    var td = document
                                        .createElement('td');
                                    td.innerHTML = "<table style='float:left; width:70%;'><tr class='innerTableRow'> <td style='width:5%; border:0px;'><input type='checkbox' class='checkboxSize' name='selectedFile' id='CheckBox_"
                                        + obj.fileId
                                        + "' onclick=getFileForCopy('"
                                        + obj.filePath
                                        + "','"
                                        + obj.pdfFilePath
                                        + "','"
                                        + obj.fileId
                                        + "','"
                                        + encodeURIComponent(obj.fileName)
                                        + "','"
                                        + encodeURIComponent(obj.treePath)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch1)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch2)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch3)
                                        + "') value='"
                                        + obj.fileId
                                        + "'/></td><td style='border:0px;' id='cutCopyId_"
                                        + obj.fileId
                                        + "' class='cls-context-menu-link' onclick= populateVersions('"+obj.fileId+"'),getFileName('"
                                        + obj.filePath
                                        + "','"
                                        + obj.pdfFilePath
                                        + "','"
                                        + obj.fileId
                                        + "','"
                                        + encodeURIComponent(obj.fileName)
                                        + "','"
                                        + encodeURIComponent(obj.treePath)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch1)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch2)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch3)
                                        + "');editFileName('"
                                        + obj.filePath
                                        + "','"
                                        + obj.pdfFilePath
                                        + "','"
                                        + obj.fileId
                                        + "','"
                                        + encodeURIComponent(obj.fileName)
                                        + "','"
                                        + encodeURIComponent(obj.treePath)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch1)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch2)
                                        + "','"
                                        + encodeURIComponent(obj.fileSearch3)
                                        + "','"
                                        + encodeURIComponent(obj.createdAt)
                                        + "','"
                                        + encodeURIComponent(obj.createdOn)
                                        + "','"
                                        + encodeURIComponent(obj.userNameFd)
                                        + "','"
                                        + encodeURIComponent(obj.userGroup)
                                        + "','"
                                        + encodeURIComponent(obj.fileSizeFd)
                                        + "')>"
                                        + obj.fileName
                                        + "</td></tr></table>";


                                    var keywords = "";
                                    if (obj.fileSearch1) {
                                        keywords = obj.fileSearch1
                                            + ","
                                    }
                                    if (obj.fileSearch2) {
                                        keywords = keywords
                                            + obj.fileSearch2
                                            + ","
                                    }

                                    if (obj.fileSearch3) {
                                        keywords = keywords
                                            + obj.fileSearch3
                                            + ","
                                    }
                                    if (keywords) {
                                        keywords = keywords.slice(
                                            0, -1)
                                    }


                                    if (encodeURIComponent(
                                        obj.fileName).includes(
                                        ".pdf")) {
                                        td.innerHTML = td.innerHTML
                                            + "<span style='float:right'>"
                                            + keywords
                                            + "&nbsp; | &nbsp;"
                                            + obj.createdAt
                                            + "</span>";
                                    } else {
                                        td.innerHTML = td.innerHTML
                                            + "<span style='float:right'>"
                                            + keywords
                                            + "&nbsp; | &nbsp;"
                                            + obj.createdAt
                                            + "&nbsp;</span>";
                                    }
                                    td.innerHTML = td.innerHTML
                                        + "<span style='float:right'>"
                                        + keywords
                                        + "&nbsp; | &nbsp;"
                                        + obj.currentVersion
                                        + "</span>";
                                    tr.appendChild(td);

                                }
                            });
                    if (!found) {
                        document.getElementById("addFolderDiv").style.display = "none";
                    }
                    document.getElementById("shownDocuments").innerHTML = "Shown "
                        + fileSize + " Documents";
                },
                error: function (error) {
                    console.log(`Error ${error}`);
                }
            });

    }

    /** Get Selected Files Name Function Start Here**/
    /**This Function used to Select Multiple Files for download files bulk or delet **/
    function getFileName(filePath, pdfFilePath, fileId, fileName, treePath, keyword1, keyword2, keyword3) {


        /* if (document.getElementById("CheckBox_" + fileId).checked) {
            document.getElementById("CheckBox_" + fileId).checked = true;
        } else {
            document.getElementById("CheckBox_" + fileId).checked = false;
        }

        var checkboxes = document.getElementsByName('selectedFile');
        var selected = [];
        for (var i = 0; i < checkboxes.length; i++) {
            if (checkboxes[i].checked) {
                selected.push(checkboxes[i].value);
            }
        }

        fileId = selected.join(",");
        //$('#fileDetails div').remove();
        //document.getElementById("fileDetails").style.display = "block";
        //document.getElementById("documentDetails").style.height = Math.floor((Number(screen.height) - Number(336))/2)	+ "px";
        //document.getElementById("fileDetails").style.height = Math.floor((Number(screen.height) - Number(336))/2)	+ "px";
        $("#fileTable tr").click(function() {
            //var selected = $(this).hasClass("highlight");
            $("#fileTable tr").removeClass("highlight");
            $(this).addClass("highlight");
            //if(!selected)
            //      $(this).addClass("highlight");
        });
        document.getElementById("downloadPdfFile").href = "/downloadFile?filePath="
                + pdfFilePath + "&fileId=" + fileId + "&pdfFile=Yes";
        document.getElementById("downloadActualFile").href = "/downloadFile?filePath="
                + filePath + "&fileId=" + fileId + "&pdfFile=No";
        document.getElementById("splitFileName").innerText = decodeURIComponent(fileName);
        document.getElementById("splitFileId").value = fileId;

        if (fileId != null) {
            localStorage.setItem("selectedFileId", fileId);
        } */

        $("#fileTable tr").click(function () {
            //var selected = $(this).hasClass("highlight");
            $("#fileTable tr").removeClass("highlight");
            $(this).addClass("highlight");
            //if(!selected)
            //      $(this).addClass("highlight");
        });
        var res = pdfFilePath.replace("//localhost/Repo/",
            "http://localhost:80/");
        document.getElementById("showPDF").src = res;
        /* document.getElementById("showPDF").src = res+"#toolbar=0"; */ /*Remove chrome pdf viewer's toolbar*/
    }

    /** Get Selected Files Name Function End Here**/

    function getFileForCopy(filePath, pdfFilePath, fileId, fileName, treePath, keyword1, keyword2, keyword3) {


        if (document.getElementById("CheckBox_" + fileId).checked) {
            document.getElementById("CheckBox_" + fileId).checked = true;
        } else {
            document.getElementById("CheckBox_" + fileId).checked = false;
        }

        var checkboxes = document.getElementsByName('selectedFile');
        var selected = [];
        for (var i = 0; i < checkboxes.length; i++) {
            if (checkboxes[i].checked) {
                selected.push(checkboxes[i].value);
            }
        }

        fileId = selected.join(",");
        //$('#fileDetails div').remove();
        //document.getElementById("fileDetails").style.display = "block";
        //document.getElementById("documentDetails").style.height = Math.floor((Number(screen.height) - Number(336))/2)	+ "px";
        //document.getElementById("fileDetails").style.height = Math.floor((Number(screen.height) - Number(336))/2)	+ "px";
        $("#fileTable tr").click(function () {
            //var selected = $(this).hasClass("highlight");
            $("#fileTable tr").removeClass("highlight");
            $(this).addClass("highlight");
            //if(!selected)
            //      $(this).addClass("highlight");
        });
        document.getElementById("downloadPdfFile").href = "/downloadFile?filePath="
            + pdfFilePath + "&fileId=" + fileId + "&pdfFile=Yes";
        document.getElementById("downloadActualFile").href = "/downloadFile?filePath="
            + filePath + "&fileId=" + fileId + "&pdfFile=No";
        document.getElementById("splitFileName").innerText = decodeURIComponent(fileName);
        document.getElementById("splitFileId").value = fileId;

        if (fileId != null) {
            localStorage.setItem("selectedFileId", fileId);
        }
        /* var res = pdfFilePath.replace("//192.168.1.13/Repo/",
                "http://192.168.1.13:8887/");
        document.getElementById("showPDF").src = res; */
    }


    /**Not Used**/
    function removeFileProperties() {
        document.getElementById('cprNo').value = "";
        document.getElementById('staffId').value = "";
        document.getElementById('staffCode').value = "";
    }

    /**Not Used**/

    function updateFile(fileId) {
        cprNo = document.getElementById('cprNo').value;
        staffId = document.getElementById('staffId').value;
        staffCode = document.getElementById('staffCode').value;
        if (cprNo != "" || staffId != "" || staffCode != "") {
            $.ajax({
                url: '/updateFileProperty?fileId=' + fileId + '&cprId='
                    + cprNo + '&staffId=' + staffId + '&staffCode='
                    + staffCode,
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    alert("File Property got updated");
                },
                error: function (xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    alert(err.message);
                    if (err.message.includes("Session Expired")) {
                        window.location.href = "/login";
                    }
                }
            });
        } else {
            alert("Please populate atleast one parameter before submitting.");

        }

    }


    /** Edit File Name Function Start Here **/
    function editFileName(filePath, pdfFilePath, fileId, fileName, treePath, keyword1, keyword2, keyword3, createdAt, createdOn, userNameFd, userGroup, fileSizeFd) {
        $('#fileDetails div').remove();
        $('#fileDetailsD div').remove();
        document.getElementById("fileDetails").style.display = "block";
        document.getElementById("documentDetails").style.display = "block";

        document.getElementById("documentDetailsTr").style.height = "50%";
        document.getElementById("fileDetailsTr").style.height = "50%";


        if (decodeURIComponent(keyword1) == 'null') {
            keyword1 = '';
        }
        if (decodeURIComponent(keyword2) == 'null') {
            keyword2 = '';
        }
        if (decodeURIComponent(keyword3) == 'null') {
            keyword3 = '';
        }

        $("#fileDetails")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>File Name : </span><span><input type='text' id='editFileName' value='"
                + decodeURIComponent(fileName)
                + "' /> <input type='hidden' id='editFileId' /></span></div>")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Keyword 1 : </span><span><input type='text' id='fileSearchParam1' value='"
                + decodeURIComponent(keyword1)
                + "' /> </span></div>")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Keyword 2 : </span><span><input type='text' id='fileSearchParam2' value='"
                + decodeURIComponent(keyword2)
                + "' /> </span></div>")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Keyword 3 : </span><span><input type='text' id='fileSearchParam3' value='"
                + decodeURIComponent(keyword3)
                + "' /> </span></div>")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>File Date : </span><span><input type='date' id='createdDate' value='"
                + decodeURIComponent(createdAt)
                + "' /> </span></div>")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Uploaded Date : </span><span><label id='createdDate2'>"
                + decodeURIComponent(createdOn)
                + " By " + userNameFd + " " + userGroup
                + "</label> </span></div>")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>File Size : </span><span><label id='docSize'>"
                + formatBytes(fileSizeFd) + " (" + fileSizeFd + " bytes)"
                + "</label> </span></div>")
            .append(
                "<div style='padding: .5rem;'><span style='display: inline-block;width:100px;'>Folder : </span><span><label id='folderNamePath'>"
                + decodeURIComponent(treePath).replaceAll(",", "/").replaceAll("[", "").replaceAll("]", "")
                + "</label> </span></div>")
            .append(
                "<div id='editFileResponse' style='font-size: 18px; color: red; font-weight: bold; padding-left: 20px;'></div>")
            .append(
                "<div class='modal-footer' style='padding: 5px 15px 5px 0px;'> <button type='button' class='btn btn-primary' onclick='updateFileName()''>update</button></div>");
        /* .append(
        "<div class='modal-footer'> <button type='button' class='btn btn-secondary' onclick='cancelFileDetailsPopup()''>Cancel</button> <button type='button' class='btn btn-primary' onclick='updateFileName()''>update</button></div>"); */
        document.getElementById('editFileId').value = fileId;
        //getFileName(filePath, pdfFilePath, fileId, fileName, treePath, keyword1, keyword2, keyword3)

        /* document.getElementById('editFileName').value=decodeURIComponent(fileName);
        document.getElementById('editFileId').value=fileId;
        document.getElementById('fileSearchParam1').value=decodeURIComponent(fileSearchParam1);
        document.getElementById('fileSearchParam2').value=decodeURIComponent(fileSearchParam2);
        document.getElementById('fileSearchParam3').value=decodeURIComponent(fileSearchParam3); */

    }

    /** Edit File Name Function End Here **/


    /** Update File Name Function Start Here **/
    function updateFileName() {
        document.getElementById('editFileResponse').innerHTML = "";
        fileId = document.getElementById('editFileId').value;
        fileName = document.getElementById('editFileName').value;
        fileSearchParam1 = document.getElementById('fileSearchParam1').value;
        fileSearchParam2 = document.getElementById('fileSearchParam2').value;
        fileSearchParam3 = document.getElementById('fileSearchParam3').value;
        createdDate = document.getElementById('createdDate').value;
        if (document.getElementById('editFileName').value != '') {
            $
                .ajax({
                    url: '/updateFileName?fileId=' + fileId + "&fileName="
                        + fileName + "&fileSearch1=" + fileSearchParam1
                        + "&fileSearch2=" + fileSearchParam2
                        + "&fileSearch3=" + fileSearchParam3
                        + "&createdDate=" + createdDate,
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (data) {
                        /* document.getElementById('editFileResponse').innerHTML = "<p style='padding-left:10px; color:red'>File details got updated!</p>"; */
                        refreshFile();
                        alert('File property got updated');
                    },
                    error: function (xhr, status, error) {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        }
                    }
                });
        }
    }

    /** Update File Name Function End Here **/

    /** Merge PDF File Icon Onclick Function Start Here **/
    function mergePdfFile(fileId) {

        if (localStorage.getItem("selectedFileId") != null
            && localStorage.getItem("selectedFileId").indexOf(',') != -1) {
            alert("More than one file has been selected. Please select only one file to perform Merge activity");
            $('#FileMergeModal').modal('hide');
        } else {

            document.getElementById('selectedFileId').value = fileId;

            $('#FileMergeModal').modal('show');
        }

    }

    /** Merge PDF File Icon Onclick Function End Here **/

    /** This function check the file is selected and not more than one file and check the file is pdf only**/
    function mergePdfFiles2() {
        if (localStorage.getItem("selectedFileId") != null
            && localStorage.getItem("selectedFileId").indexOf(',') != -1) {
            alert("More than one file has been selected. Please select only one file to Merge");
        } else {
            if (localStorage.getItem("selectedFileId") == 'undefined'
                || localStorage.getItem("selectedFileId") == 'null'
                || localStorage.getItem("selectedFileId") == null
                || localStorage.getItem("selectedFileId") == "") {

                alert("Please select the file to Merge");
                $('#FileMergeModal').modal('hide');
            } else if (!document.getElementById("splitFileName").innerText
                .includes(".pdf")) {
                alert("Please select PDF file to Merge");
                $('#FileMergeModal').modal('hide');
            } else {
                var fileId = localStorage.getItem("selectedFileId");
                document.getElementById('selectedFileId').value = fileId;
                $('#FileMergeModal').modal('show');
            }
        }
    }

    /** Split File Icon Onclick Function End Here**/

    /** Merge PDF File Function Start Here **/
    function mergePdfFiles() {
        document.getElementById('mergeFileResponse').innerHTML = "";
        var formData = new FormData();
        var otherFile = false;
        var pdfFile = false;
        if (mergeFiles.length > 0) {
            for (var i = 0, len = mergeFiles.length; i < len; i++) {
                formData.append('files', mergeFiles[i]);
                if (mergeFiles[i].name.includes(".pdf")) {
                    pdfFile = true;
                } else {
                    otherFile = true;
                }
            }

            if (!otherFile) {
                document.getElementById('uploadFileButton').disabled = true;
                $("#mergeLoader").show();
                formData.append('nodeId', localStorage.getItem("selectedNode"));
                formData.append('fileId', document
                    .getElementById('selectedFileId').value);
                var xhr = new XMLHttpRequest();

                // Open the connection
                xhr.open('POST', '/mergeFile', true);

                // Set up a handler for when the task for the request is complete
                xhr.onload = function () {
                    if (xhr.status == 200) {
                        refreshFile();
                        document.getElementById('mergeFileResponse').innerHTML = "<p style='padding-left:10px; color:green'>Merge completed!</p>";

                        mergeFiles = [];
                        document.getElementById("selectedFilesMerge").innerHTML = "";
                        document.getElementById("mergeFileId").value = "";
                        document.getElementById('uploadFileButton').disabled = false;
                        $("#mergeLoader").hide();
                    } else {
                        var err = JSON.parse(xhr.responseText);
                        alert(err.message);
                        if (err.message.includes("Session Expired")) {
                            window.location.href = "/login";
                        } else {
                            document.getElementById('mergeFileResponse').innerHTML = "<p>Merge error. Try again.</p>";
                            $("#mergeLoader").hide();
                            alert("Merge error. Try again.");
                            document.getElementById('uploadFileButton').disabled = false;
                        }

                    }
                };

                // Send the data.
                xhr.send(formData);
            } else {
                alert("Please choose the PDF file for Merge");
            }
            //formData.append('file', file);

        } else {
            alert("Please choose the file to Merge");
        }

    }

    /** Merge PDF File Function End Here **/

    function removeMessages() {
        document.getElementById('uploadResponse').innerHTML = "";
        document.getElementById('editFileResponse').innerHTML = "";
        document.getElementById('mergeFileResponse').innerHTML = "";
        document.getElementById('editUserResponse').innerHTML = "";
        document.getElementById('addUserGroupResponse').innerHTML = "";
        document.getElementById('editUserGroupResponse').innerHTML = "";
        document.getElementById('addUserResponse').innerHTML = "";
        document.getElementById('addStampResponse').innerHTML = "";
        document.getElementById('checkInResponse').innerHTML = "";
    }

    function cancelFileDetailsPopup() {
        document.getElementById('uploadResponse').innerHTML = "";
        document.getElementById('editFileResponse').innerHTML = "";
        document.getElementById('mergeFileResponse').innerHTML = "";
        document.getElementById("fileDetails").style.display = "none";
        document.getElementById("documentDetails").style.display = "block";
        document.getElementById("documentDetailsTr").style.height = "100%";
    }


</script>

<script th:src="@{/webjars/jquery/jquery.min.js}"></script>
<script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/4.0.0-2/js/bootstrap.min.js}"></script>
<script th:src="@{/assets/jquery-treetable/jquery.treetable.js}"></script>
</html>